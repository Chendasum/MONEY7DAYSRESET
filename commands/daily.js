const User = require("../models/User");
const Progress = require("../models/Progress");
const { sendLongMessage } = require("../utils/message-splitter");

// Configuration constants
const CONFIG = {
    MESSAGE_CHUNK_SIZE: 2500, // Reduced for better delivery
    TOTAL_DAYS: 7,
    DEFAULT_DELAY: 1500 // Increased delay between chunks
};

// Content optimization functions
const contentOptimization = {
    optimizeContentDelivery: (content, maxLength = 2500) => {
        if (content.length <= maxLength) return [content];
        
        // Split by sections first (look for multiple line breaks)
        const sections = content.split(/\n\n\n+/);
        const chunks = [];
        let currentChunk = '';
        
        sections.forEach(section => {
            if (currentChunk.length + section.length <= maxLength) {
                currentChunk += section + '\n\n';
            } else {
                if (currentChunk.trim()) chunks.push(currentChunk.trim());
                currentChunk = section + '\n\n';
            }
        });
        
        if (currentChunk.trim()) chunks.push(currentChunk.trim());
        return chunks;
    },
    
    generateVisualProgress: (completedDays, totalDays = 7) => {
        const percentage = Math.round((completedDays.length / totalDays) * 100);
        const filled = Math.floor(percentage / 10);
        const empty = 10 - filled;
        
        return `📊 **វឌ្ឍនភាព: ${percentage}%**\n${'🟩'.repeat(filled)}${'⬜'.repeat(empty)} (${completedDays.length}/${totalDays})`;
    }
};

// Gamification system
const gamificationSystem = {
    calculateAchievements: (userProgress) => {
        const achievements = [];
        const totalSaved = userProgress.totalMoneySaved || 0;
        const completedDays = userProgress.completedDays || [];
        
        // Money achievements
        if (totalSaved >= 50) achievements.push("💰 អ្នករកប្រាក់ Bronze");
        if (totalSaved >= 100) achievements.push("💎 អ្នករកប្រាក់ Silver");
        if (totalSaved >= 200) achievements.push("🏆 អ្នករកប្រាក់ Gold");
        
        // Consistency achievements
        if (completedDays.length >= 3) achievements.push("🔥 ការប្តេជ្ញាចិត្ត 3 ថ្ងៃ");
        if (completedDays.length >= 7) achievements.push("⭐ អ្នកចាំថ្ងៃ 7 ថ្ងៃ");
        
        return achievements;
    }
};

// Error handling
const errorHandling = {
    gracefulFallback: async (bot, chatId, error, context) => {
        console.error(`Error in ${context}:`, error);
        
        const fallbackMessage = `🔧 **មានបញ្ហាបច្ចេកទេសតូចៗ**

💡 **ការដោះស្រាយ:**
• ចុច /start ដើម្បីចាប់ផ្តើមឡើងវិញ
• ទាក់ទង @Chendasum សម្រាប់ជំនួយ
• ឬព្យាយាមម្តងទៀតក្នុងពេល ១-២ នាទី`;
        
        try {
            await bot.sendMessage(chatId, fallbackMessage);
        } catch (sendError) {
            console.error("Failed to send fallback message:", sendError);
        }
    }
};

// Day metadata for beautiful interface
const dayMeta = {
    1: { 
        icon: "💰", 
        title: "រកប្រាក់ភ្លាមៗ", 
        subtitle: "$50-150 ក្នុង ៣០ នាទី", 
        color: "🟢",
        duration: "៣០ នាទី",
        difficulty: "ងាយស្រួល",
        value: "$300+",
        objectives: [
            "រកប្រាក់បាន $50-150 ភ្លាមៗ",
            "ស្វែងរកការជាវលាក់កំបាំង",
            "វិភាគទម្លាប់ចំណាយកម្ពុជា",
            "ទទួលឧបករណ៍គណនាលំហូរប្រាក់"
        ]
    },
    2: { 
        icon: "🎯", 
        title: "ស្វែងរកចំណុចលេច", 
        subtitle: "$100-400 ក្នុង ៤៥ នាទី", 
        color: "🔵",
        duration: "៤៥ នាទី",
        difficulty: "មធ្យម",
        value: "$500+",
        objectives: [
            "កំណត់ចំណុចលេចធ្លាយកម្រិតខ្ពស់",
            "ស្វែងរកអន្ទាក់បណ្តាញសង្គម",
            "ត្រួតពិនិត្យការជាវលាក់កំបាំង",
            "បង្កើតយុទ្ធសាស្ត្របិទចំណុចលេច"
        ]
    },
    3: { 
        icon: "📊", 
        title: "ពិនិត្យសុខភាពហិរញ្ញវត្ថុ", 
        subtitle: "ដឹងពីសុខភាពប្រាក់ក្នុង ១៥ នាទី", 
        color: "🟣",
        duration: "១៥ នាទី",
        difficulty: "ងាយស្រួល",
        value: "$200+",
        objectives: [
            "ទទួលពិន្ទុសុខភាពហិរញ្ញវត្ថុ",
            "វាយតម្លៃការតាមដានប្រាក់",
            "ពិនិត្យផែនការប្រាក់",
            "កែលម្អតាមលទ្ធភាព"
        ]
    },
    4: { 
        icon: "📈", 
        title: "គណនាលំហូរប្រាក់", 
        subtitle: "ដឹងលំហូរប្រាក់ពិតក្នុង ១០ នាទី", 
        color: "🟠",
        duration: "១០ នាទី",
        difficulty: "មធ្យម",
        value: "$250+",
        objectives: [
            "វិភាគគំរូលំហូរប្រាក់ពិតប្រាកដ",
            "កំណត់ទិសដៅកែលម្អ",
            "ពិនិត្យប្រភពចំណូល",
            "បង្កើនប្រសិទ្ធភាពចំណាយ"
        ]
    },
    5: { 
        icon: "⚖️", 
        title: "វិភាគតុល្យភាពចំណាយ", 
        subtitle: "ដឹងតុល្យភាពក្នុង ១៥ នាទី", 
        color: "🟦",
        duration: "១៥ នាទី",
        difficulty: "បន្តិចពិបាក",
        value: "$350+",
        objectives: [
            "វិភាគការរស់រានមានជីវិត vs ការលូតលាស់",
            "កំណត់អាទិភាពចំណាយ",
            "បង្កើតតុល្យភាពល្អ",
            "រៀបចំផែនការកែលម្អ"
        ]
    },
    6: { 
        icon: "🎬", 
        title: "ម៉ាទ្រីសអាទិភាព", 
        subtitle: "កំណត់ចំណុចសំខាន់ក្នុង ១០ នាទី", 
        color: "🔴",
        duration: "១០ នាទី",
        difficulty: "បន្តិចពិបាក",
        value: "$400+",
        objectives: [
            "ផែនការសកម្មភាព ៣ ចំណុច",
            "ផែនការ ៣០ ថ្ងៃច្បាស់លាស់",
            "កំណត់អាទិភាពផ្ទាល់ខ្លួន",
            "បង្កើតការទទួលខុសត្រូវ"
        ]
    },
    7: { 
        icon: "🎓", 
        title: "បញ្ចប់ការសិក្សា", 
        subtitle: "វាស់ជោគជ័យ និងជំហានបន្ទាប់", 
        color: "🟩",
        duration: "២០ នាទី",
        difficulty: "ងាយស្រួល",
        value: "$500+",
        objectives: [
            "វាស់វែងសមិទ្ធផលរយៈពេល ៧ ថ្ងៃ",
            "ទទួលកម្រិតបញ្ចប់ការសិក្សា",
            "បង្កើតទម្លាប់យូរអង្វែង",
            "ត្រៀមខ្លួនសម្រាប់កម្រិតបន្ទាប់"
        ]
    }
};

// Enhanced progress bar visualization
function generateProgressBar(completedDays, totalDays = 7) {
    const percentage = Math.round((completedDays / totalDays) * 100);
    const filledBlocks = Math.floor((completedDays / totalDays) * 10);
    const emptyBlocks = 10 - filledBlocks;
    
    const progressBar = '█'.repeat(filledBlocks) + '░'.repeat(emptyBlocks);
    
    // Add achievements
    let achievementText = '';
    if (percentage >= 50) achievementText += '🏅 ';
    if (percentage === 100) achievementText += '🎓 ';
    
    return `${achievementText}📊 **ការវឌ្ឍនភាព: ${percentage}%**\n\`${progressBar}\` (${completedDays}/${totalDays})\n`;
}

// Enhanced day overview with achievements
function createDayOverview(dayNumber, userProgress = {}) {
    const day = dayMeta[dayNumber];
    const isCompleted = userProgress.completedDays?.includes(dayNumber) || false;
    const completionDate = userProgress[`day${dayNumber}CompletedAt`];
    const timestamp = userProgress.timestamp;
    
    let message = `🔱 **7-Day Money Flow Reset™** 🔱\n\n`;
    message += `${day.color} **ថ្ងៃទី ${dayNumber}: ${day.title}**\n`;
    message += `${day.icon} *${day.subtitle}*\n\n`;
    
    // Enhanced status with achievements
    if (isCompleted) {
        message += `✅ **ស្ថានភាព:** បានបញ្ចប់ 🎉`;
        if (completionDate) {
            message += ` (${new Date(completionDate).toLocaleDateString('km-KH')})`;
        }
        message += '\n';
    } else {
        message += `🎯 **ស្ថានភាព:** រង់ចាំបញ្ចប់\n`;
    }
    
    // Add timestamp to make content unique
    if (timestamp) {
        message += `🕐 **បានមើល:** ${timestamp}\n`;
    }
    
    // Rest of your existing content...
    message += `⏱️ **រយៈពេល:** ${day.duration}\n`;
    message += `📊 **កម្រិតលំបាក:** ${day.difficulty}\n`;
    message += `💎 **តម្លៃ:** ${day.value}\n\n`;
    
    // Enhanced progress with visual elements
    if (userProgress.completedDays) {
        message += contentOptimization.generateVisualProgress(userProgress.completedDays);
        message += '\n\n';
    }
    
    // Key objectives
    message += `**🎯 គោលដៅថ្ងៃនេះ:**\n`;
    day.objectives.forEach((objective, index) => {
        message += `${index + 1}. ${objective}\n`;
    });
    
    return message;
}

// Enhanced program overview
function generateProgramOverview(progress) {
    const completedDays = progress.completedDays || [];
    const currentDay = progress.currentDay || 1;
    
    let message = `🔱 **7-Day Money Flow Reset™** 🔱\n`;
    message += `*កម្មវិធីកែលម្អលំហូរប្រាក់ ៧ ថ្ងៃ*\n\n`;
    
    // Enhanced progress
    message += generateProgressBar(completedDays.length);
    message += '\n';
    
    // Current status with achievements
    if (completedDays.length === 7) {
        message += `🎓 **ស្ថានភាព:** បានបញ្ចប់កម្មវិធី!\n`;
        message += `🏆 **កម្រិត:** Cambodia Money Flow Graduate\n\n`;
        
        // Add graduation level based on performance
        const totalSaved = progress.totalMoneySaved || 0;
        if (totalSaved >= 200) message += `💎 **ក្រាដ:** Platinum Graduate\n`;
        else if (totalSaved >= 100) message += `🥇 **ក្រាដ:** Gold Graduate\n`;
        else if (totalSaved >= 50) message += `🥈 **ក្រាដ:** Silver Graduate\n`;
        else message += `🥉 **ក្រាដ:** Bronze Graduate\n`;
    } else {
        message += `📍 **ថ្ងៃបច្ចុប្បន្ន:** ថ្ងៃទី ${currentDay}\n`;
        message += `🎯 **បន្ទាប់:** ${dayMeta[currentDay]?.title || 'បញ្ចប់កម្មវិធី'}\n\n`;
    }
    
    // Weekly overview
    message += `**📅 ទិដ្ឋភាពសប្តាហ៍:**\n`;
    for (let day = 1; day <= 7; day++) {
        const meta = dayMeta[day];
        const isCompleted = completedDays.includes(day);
        const isCurrent = day === currentDay;
        
        let status = "";
        if (isCompleted) status = "✅";
        else if (isCurrent) status = "▶️";
        else if (day <= currentDay) status = "🟡";
        else status = "🔒";
        
        message += `${status} **ថ្ងៃ ${day}:** ${meta.title}\n`;
    }
    
    return message;
}

// Enhanced navigation keyboard with achievements
function createNavigationKeyboard(currentDay, completedDays, maxAccessibleDay) {
    const keyboard = [];
    
    // Day navigation row 1 (days 1-4)
    const row1 = [];
    for (let i = 1; i <= 4; i++) {
        const isAccessible = i <= maxAccessibleDay;
        const isCompleted = completedDays.includes(i);
        const isCurrent = i === currentDay;
        
        let emoji = "";
        if (isCompleted) emoji = "✅";
        else if (isCurrent) emoji = "▶️";
        else if (isAccessible) emoji = "🟡";
        else emoji = "🔒";
        
        row1.push({
            text: `${emoji} ${i}`,
            callback_data: isAccessible ? `day_${i}` : `locked_${i}`
        });
    }
    keyboard.push(row1);
    
    // Day navigation row 2 (days 5-7)
    const row2 = [];
    for (let i = 5; i <= 7; i++) {
        const isAccessible = i <= maxAccessibleDay;
        const isCompleted = completedDays.includes(i);
        const isCurrent = i === currentDay;
        
        let emoji = "";
        if (isCompleted) emoji = "✅";
        else if (isCurrent) emoji = "▶️";
        else if (isAccessible) emoji = "🟡";
        else emoji = "🔒";
        
        row2.push({
            text: `${emoji} ${i}`,
            callback_data: isAccessible ? `day_${i}` : `locked_${i}`
        });
    }
    keyboard.push(row2);
    
    // Navigation controls
    const navRow = [];
    if (currentDay > 1) {
        navRow.push({
            text: `⬅️ ថ្ងៃមុន`,
            callback_data: `day_${currentDay - 1}`
        });
    }
    
    navRow.push({
        text: "📋 ទិដ្ឋភាពទូទៅ",
        callback_data: "overview"
    });
    
    if (currentDay < 7 && currentDay < maxAccessibleDay) {
        navRow.push({
            text: `ថ្ងៃបន្ទាប់ ➡️`,
            callback_data: `day_${currentDay + 1}`
        });
    }
    
    keyboard.push(navRow);
    
    // Enhanced action buttons
    const actionRow = [];
    actionRow.push({
        text: "🎯 ចាប់ផ្តើមមេរៀន",
        callback_data: `start_lesson_${currentDay}`
    });
    
    if (completedDays.includes(currentDay)) {
        actionRow.push({
            text: "🏆 បានបញ្ចប់",
            callback_data: `achievements_${currentDay}`
        });
    } else {
        actionRow.push({
            text: "⭐ បញ្ចប់ថ្ងៃនេះ",
            callback_data: `complete_${currentDay}`
        });
    }
    
    keyboard.push(actionRow);
    
    // Add quick access row
    const quickRow = [];
    quickRow.push({
        text: "💡 គន្លឹះថ្ងៃនេះ",
        callback_data: `tip_${currentDay}`
    });
    quickRow.push({
        text: "🏅 ជោគជ័យ",
        callback_data: "achievements"
    });
    
    keyboard.push(quickRow);
    
    return { inline_keyboard: keyboard };
}

// Daily lesson content (keeping your existing content)
const dailyMessages = {
   1: `🔱 ថ្ងៃទី ១: ចាប់ផ្តើមស្គាល់លំហូរលុយរបស់អ្នក + រកលុយភ្លាម! 🔱
---

🔥 គោលដៅថ្ងៃនេះ: រកលុយ $30-$50+ ក្នុង ២០ នាទី តាមវិធីសាស្ត្រពិតប្រាកដ!

👋 ជំរាបសួរ! ថ្ងៃនេះយើងនឹងមកយល់ដឹងអំពីលុយរបស់អ្នកឱ្យបានច្បាស់លាស់ និងរកលុយភ្លាមៗ! ចូរគិតថាវាដូចជាការស្វែងរក 'ចំណុចលេចធ្លាយលុយ' តូចៗដែលអ្នកប្រហែលជាមិនធ្លាប់ដឹង!

💎 តំបន់សកម្មភាពបន្ទាន់ (២០ នាទី)

⚡ ជំហានភ្លាមៗ (៥ នាទី): ពិនិត្យមើលការជាវឌីជីថល (Digital Subscriptions)
→ បើក Phone Settings → Subscriptions/App Store
→ រកមើលកម្មវិធីដែលអ្នកលែងប្រើប្រាស់ហើយ
→ គោលដៅ: រកឃើញ $15+ ភ្លាមៗដែលអ្នកអាចសន្សំបានរៀងរាល់ខែ

💡 ចំណុចលេចធ្លាយលុយឌីជីថលទូទៅនៅកម្ពុជា:
• Netflix/YouTube Premium មិនបានមើល: $10-15/ខែ = $120-180/ឆ្នាំ
• Spotify មិនបានស្តាប់: $10/ខែ = $120/ឆ្នាំ
• កម្មវិធីហ្គេមមិនបានលេង (PUBG/FreeFire): $5-20/ខែ = $60-240/ឆ្នាំ
• VPN/Cloud storage ភ្លេចបន្ត: $5-15/ខែ = $60-180/ឆ្នាំ

🚗 ជំហានភ្លាមៗ (១០ នាទី): ពិនិត្យទម្លាប់ចំណាយប្រចាំថ្ងៃនៅកម្ពុជា
→ Grab ចម្ងាយខ្លីក្រោម ២ គីឡូម៉ែត្រ: គិត $3-5/ដង × 10ដង = $30-50/ខែ
→ កាហ្វេហាង (Brown/Amazon): គិត $2/ថ្ងៃ × 20ថ្ងៃ = $40/ខែ
→ ថ្លៃដឹកជញ្ជូនអាហារ (FoodPanda): គិត $1-2 ថ្លៃដឹក × 15ដង = $15-30/ខែ
→ ការទិញតាម Facebook ads: ពិនិត្យមើលការចំណាយក្នុងរយៈពេល ៧ ថ្ងៃចុងក្រោយ = ?

⚡ ជំហានភ្លាមៗ (៥ នាទី): អនុវត្តឥឡូវនេះ!
→ លុបចោល ឬ បោះបង់ការជាវ (Subscription) មួយមុខឥឡូវនេះ (អ្នកនឹងភ្ញាក់ផ្អើលថាតើអ្នកសន្សំបានប៉ុន្មាន!)
→ គ្រោងជំនួស Grab ដោយជិះម៉ូតូឬរថយន្តផ្ទាល់ខ្លួន ២-៣ ដងនៅថ្ងៃស្អែក
→ គ្រោងធ្វើកាហ្វេនៅផ្ទះសម្រាប់ ៣ ថ្ងៃនេះ

📊 គណនាភ្លាមៗ - សរសេរចំនួនពិតប្រាកដ:
- ការបោះបង់ការជាវ: $____/ខែ
- កាត់បន្ថយការជិះ Grab: $____/ខែ
- កាត់បន្ថយការទិញកាហ្វេនៅហាង: $____/ខែ
- កាត់បន្ថយថ្លៃដឹកជញ្ជូនអាហារ: $____/ខែ
សរុបប្រាក់ដែលបានរកឃើញ: $____/ខែ = $____/ឆ្នាំ! (នេះជាប្រាក់ដែលអ្នកទើបតែបានរកឃើញ!)

🏆 ការធានា: រកមិនបាន $30/ខែ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការប្រឹក្សាឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យពិត (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 លោក វិចិត្រ (៣៥ ឆ្នាំ, បុគ្គលិកការិយាល័យ, សៀមរាប):
"ខ្ញុំបានរកឃើញការជាវដែលភ្លេចតាំងពី $65/ខែ - គិតឡើងវិញហើយឥឡូវសន្សំបានច្រើន!"

---

🎯 តើហេតុអ្វីបានជាលំហូរលុយសំខាន់?

💡 លំហូរលុយ = លុយចូល - លុយចេញ = ប្រាក់សេសសល់

ជីវិតរបស់យើងប្រៀបដូចជាបង្អួចមួយ... លុយចូលមកពីទ្វារមួយ ហើយចេញពីទ្វារមួយទៀត។ បញ្ហាគឺយើងភាគច្រើនមិនដឹងថាវាចេញតាមផ្លូវណាខ្លះនោះទេ! ការគ្រប់គ្រងលំហូរលុយមិនមែនត្រឹមតែរាប់លុយនោះទេ... វាដូចជាការធ្វើកំណត់ហេតុសុខភាពហិរញ្ញវត្ថុរបស់អ្នកផ្ទាល់!

💰 តើលុយចូលមកពីណាខ្លះ? (៤ ប្រភេទសំខាន់)

🟢 ចំណូលទៀងទាត់:
• ប្រាក់ខែ ឬ ប្រាក់ឈ្នួលប្រចាំថ្ងៃពីការងារ
• កម្រៃជើងសារពីការលក់
• ប្រាក់ចំណូលពីកិច្ចសន្យាការងារ

🔵 ចំណូលបន្ថែម:
• អាជីវកម្មខ្នាតតូចដែលធ្វើនៅពេលទំនេរ (តាក់ស៊ី, Grab)
• ការបង្រៀនបន្ថែម
• ការលក់ទំនិញតាមអនឡាញ (Facebook, TikTok Shop)

🟡 ចំណូលដោយស្វ័យប្រវត្តិ:
• ការប្រាក់ពីធនាគារ (ACLEDA, ABA)
• ប្រាក់ចំណេញពីការវិនិយោគ (បើមាន)
• ប្រាក់ជួលផ្ទះ ឬ បន្ទប់ជួល

🟠 ចំណូលម្តងម្កាល:
• ប្រាក់រង្វាន់ពីក្រុមហ៊ុន
• ប្រាក់អំណោយពីកាដូរ/ពិធីបុណ្យ
• ការលក់របស់របរចាស់ៗ

💸 តើលុយចេញទៅណាខ្លះ? (៤ ក្រុមសំខាន់)

🔴 ចំណាយចាំបាច់ (៤០-៥០%):
• ថ្លៃជួលផ្ទះ, ទឹក ភ្លើង និងអ៊ីនធឺណិត
• ថ្លៃសាលារៀនកូនៗ
• ប្រាក់កម្ចីធនាគារ/ប្រាក់បង់រំលោះ
• ធានារ៉ាប់រង, ថ្លៃទូរស័ព្ទ (Smart, Cellcard)

🟡 ចំណាយអាហារ និងសំលៀកបំពាក់ (២៥-៣៥%):
• ម្ហូបអាហារ (ពីផ្សារ + ញ៉ាំនៅខាងក្រៅ)
• សំលៀកបំពាក់
• ថ្លៃថ្នាំពេទ្យ ឬ ថ្លៃព្យាបាល
• ការធ្វើដំណើរ (សាំង, តាក់ស៊ី)

🟢 ចំណាយកម្សាន្ត (១៥-២៥%):
• ទៅកម្សាន្តកន្លែងផ្សេងៗ (KTV, Pub Street)
• ញ៉ាំកាហ្វេនៅហាង
• ទិញរបស់របរដែលចង់បាន
• លេងកីឡា និងចំណូលចិត្ត (Hobby)

🔵 ចំណាយពិសេស:
• ពិធីបុណ្យផ្សេងៗ (ភ្ជុំបិណ្ឌ, ចូលឆ្នាំ)
• ជួយសមាជិកគ្រួសារ
• ជួសជុលផ្ទះ ឬ ម៉ូតូ

🎯 ការគណនាឆ្លាតវៃ:
ចំណូលសរុប - ចំណាយសរុប = ប្រាក់សេសសល់

ឧទាហរណ៍នៅកម្ពុជា: ចំណូល $800 - ចំណាយ $750 = សល់ $50

បើលុយសល់ = ល្អ 👍
បើលុយអស់ = ត្រូវកែលម្អឡើងវិញ

📊 ក្បួន ៥០/៣០/២០ (ក្បួនមាស - The Golden Rule):
ជាឧទាហរណ៍ ចំណូលប្រចាំខែ $1000:
🔴 ៥០% = $500 សម្រាប់ចំណាយចាំបាច់ (ផ្ទះ, អាហារ, ការធ្វើដំណើរ)
🟡 ៣០% = $300 សម្រាប់ចំណាយតាមចំណង់ (កម្សាន្ត, ទិញអ្វីល្អៗ)
🟢 ២០% = $200 សម្រាប់សន្សំ (អនាគត, ពេលបន្ទាន់)

ក្បួនមាសនេះជួយ:
✅ មិនចំណាយហួសកម្រិត
✅ មានលុយសន្សំទុក
✅ រស់នៅប្រកបដោយតុល្យភាព

---

🎯 ផែនការសកម្មភាពថ្ងៃនេះ:

✅ ជំហានទី១ - ចាប់ផ្តើមពិនិត្យចំណូលរបស់អ្នក
→ គិតមើលថាអ្នកមានចំណូលពីប៉ុន្មានប្រភព?
→ មួយណាជាចំណូលទៀងទាត់ មួយណាជាចំណូលមិនស្ថិរភាព?

✅ ជំហានទី២ - ពិនិត្យចំណាយរបស់អ្នក
→ តើថ្ងៃណាខ្លះដែលអ្នកចំណាយច្រើនបំផុត?
→ តើចំណាយមួយណាដែលអ្នកអាចកាត់បន្ថយបាន?

✅ ជំហានទី៣ - ចាប់ផ្តើមស្វែងរកចំណុចលេចធ្លាយលុយ
→ ដាក់គំនិតចំណាយតូចៗដែលកើនឡើងជាប្រចាំ
→ ចាប់ផ្តើមកាត់បន្ថយ ១-២ មុខភ្លាមៗ (អ្នកអាចធ្វើវាបាន!)

💭 សំណួរសម្រាប់ការពិចារណាដោយខ្លួនឯង:
១. "តើចំណូលរបស់ខ្ញុំមកពីប៉ុន្មានប្រភព? មានតែមួយ ឬ មានច្រើន?"
២. "ចំណាយមួយណាខ្លះដែលខ្ញុំអាចកាត់បន្ថយបាន?"
៣. "ខ្ញុំចំណាយច្រើនលើអ្វីដែលចាំបាច់ ឬ លើអ្វីដែលចង់បាន?"
៤. "បើសិនជាមានបញ្ហាបន្ទាន់ ខ្ញុំមានលុយទុកដែរឬទេ?"

🎉 គន្លឹះជោគជ័យ:
- ត្រូវតែស្មោះត្រង់ - កុំលាក់បាំងតួលេខពិតប្រាកដ!
- មើលទៅរយៈពេលវែង - ពិនិត្យតាមដានរយៈពេល ៣-៦ ខែ
- ផ្តោតលើទម្លាប់ចំណាយ មិនមែនត្រឹមតែចំនួនលុយច្រើនតិច
- រកមូលហេតុពិតប្រាកដ កុំត្រឹមតែកែលម្អលទ្ធផល
- ចាប់ផ្តើមភ្លាមៗ - រកលុយបានថ្ងៃនេះ!

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមកត់ត្រាចំណាយជារៀងរាល់ថ្ងៃ
- ត្រូវប្រយ័ត្នចំណាយ "តូចៗ" (ពួកវាអាចកើនឡើងយ៉ាងលឿនដោយមិនដឹងខ្លួន!)
- ព្យាយាមអនុវត្តការកាត់បន្ថយដែលបានគ្រោងទុកនៅថ្ងៃនេះ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: រកបាន $30+ ថ្ងៃនេះ → ទទួលបាន "បញ្ជីត្រួតពិនិត្យចំណុចលេចធ្លាយលុយនៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 1 COMPLETE - រកបាន $____/ខែ" ដើម្បីឆ្ពោះទៅថ្ងៃទី ២!

ស្អែកយើងនឹងធ្វើការស្វែងរក "ប្រព័ន្ធកំណត់អត្តសញ្ញាណចំណុចលេចធ្លាយលុយកម្រិតខ្ពស់" ដើម្បីរកកន្លែងដែលលុយលេចធ្លាយទៅដោយមិនដឹងខ្លួន!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day2`,

   2: `🔱 ថ្ងៃទី ២: ការកំណត់អត្តសញ្ញាណចំណុចលេចធ្លាយលុយកម្រិតខ្ពស់ - រកបាន $50-200 ក្នុង 30 នាទី! 🔱

🔥 គោលដៅថ្ងៃនេះ: រកចំណុចលេចធ្លាយលុយ $50+ ក្នុង ៣០ នាទី តាមវិធីសាស្ត្រពិតប្រាកដ!

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃម្សិលមិញអ្នកបានរកលុយ $30+ រួចហើយ។ ថ្ងៃនេះយើងនឹងស្វែងរកចំណុចលេចធ្លាយលុយសម្ងាត់ដែលធ្វើឱ្យអ្នកខាតបង់កាន់តែច្រើន! គិតថាវាដូចជាការស្វែងរក 'ស្នាមប្រេះតូចៗ' នៅក្នុងប្រព័ន្ធហិរញ្ញវត្ថុរបស់អ្នក។

💎 ប្រព័ន្ធកំណត់អត្តសញ្ញាណចំណុចលេចធ្លាយកម្រិតខ្ពស់ (៣០ នាទី)

⚡ ជំហានទី១ (១០ នាទី): ពិនិត្យមើលអន្ទាក់ចំណាយតាមបណ្តាញសង្គម
→ បើក Facebook/Instagram/TikTok payment history
→ រកមើលការផ្សាយពាណិជ្ជកម្មដែលបានចុច និងទិញដោយមិនចាំបាច់
→ គោលដៅ: រកឃើញ $25+ ពីការចំណាយលើបណ្តាញសង្គម

💡 ចំណុចលេចធ្លាយលុយតាមបណ្តាញសង្គមនៅកម្ពុជា:
• ការទិញទំនិញតាម Facebook ads ដោយមិនគិត: $10-50/ខែ
• ការជាវកម្មវិធីទូរស័ព្ទដែលមិនប្រើ: $5-20/ខែ
• ការចំណាយលើហ្គេមអនឡាញ: $5-30/ខែ
• ការទិញរបស់របរតាម TikTok Shop ដោយសារការផ្សាយពាណិជ្ជកម្ម: $10-40/ខែ

⚡ ជំហានទី២ (១០ នាទី): ត្រួតពិនិត្យការជាវលាក់កំបាំង
→ ពិនិត្យ Email inbox របស់អ្នករកពាក្យ "subscription", "renewal", "payment"
→ ពិនិត្យរាល់ការកាត់លុយដោយស្វ័យប្រវត្តិពី Bank statement របស់អ្នកដោយប្រុងប្រយ័ត្ន
→ គោលដៅ: រកឃើញការជាវដែលភ្លេច $20+

💡 ការជាវលាក់កំបាំងនៅកម្ពុជា:
• កម្មវិធីណាត់ជួប (Tinder, Bumble): $15-30/ខែ
• វេទិកាសិក្សា (Coursera, Udemy): $10-50/ខែ
• Cloud storage (Google, iCloud): $2-15/ខែ
• សេវាកម្ម VPN ពីមុន: $5-15/ខែ

⚡ ជំហានទី៣ (១០ នាទី): ការកាត់បន្ថយលុយពីទម្លាប់តូចៗ
→ គណនាទម្លាប់ចំណាយតូចៗជារៀងរាល់ថ្ងៃ (កាហ្វេ, ទឹកកក, បារី)
→ ពិនិត្យមើលចំណាយដែលអ្នកធ្វើដោយមិនបានគិត
→ គោលដៅ: រកឃើញទម្លាប់ប្រចាំថ្ងៃដែលលេចធ្លាយ $30+/ខែ

💡 ចំណុចលេចធ្លាយលុយប្រចាំថ្ងៃតូចៗនៅកម្ពុជា:
• ទឹកកក/ភេសជ្ជៈ $1 × 25ថ្ងៃ = $25/ខែ
• កាហ្វេនៅការិយាល័យ $1.5 × 20ថ្ងៃ = $30/ខែ
• ស្រាបៀរ $3 × 10ដង = $30/ខែ
• ថ្នាំបារី/បង្អែម $0.5 × 30ថ្ងៃ = $15/ខែ

📊 ម៉ាស៊ីនគណនាចំណុចលេចធ្លាយ - គណនាភ្លាមៗ:
- ការទិញភ្លាមៗតាមបណ្តាញសង្គម: $____/ខែ
- ការជាវលាក់កំបាំង: $____/ខែ
- ទម្លាប់ចំណាយតូចៗប្រចាំថ្ងៃ: $____/ខែ
- ចំណុចលេចធ្លាយផ្សេងទៀតដែលបានរកឃើញ: $____/ខែ
សរុបចំណុចលេចធ្លាយដែលរកឃើញ: $____/ខែ = $____/ឆ្នាំ! (អ្នកទើបតែបិទកន្លែងខាតធំ!)

🏆 ការធានា: រកមិនបាន $50/ខែ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការវិភាគប្រព័ន្ធលុយឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យការកំណត់អត្តសញ្ញាណកម្រិតខ្ពស់ (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 អ្នកស្រី ច័ន្ទលី (២៤ ឆ្នាំ, Marketing, ភ្នំពេញ):
"ខ្ញុំបានវិភាគរកឃើញការជាវ និងទម្លាប់ដែលភ្លេច - សន្សំបានប្រមាណ $85/ខែ!"

---

🚨 តើអ្វីទៅជាចំណុចលេចធ្លាយលុយ?

ចំណុចលេចធ្លាយលុយ គឺដូចជាបំពង់ទឹកដែលលេចធ្លាយតូចៗ... ពេលដំបូងអ្នកមិនសូវកត់សម្គាល់ទេ តែបើសិនជាទុកចោលយូរ វានឹងធ្វើឱ្យអ្នកខាតបង់ទឹកយ៉ាងច្រើន!

💡 ឧទាហរណ៍ចំណាយប្រចាំថ្ងៃដែលគេតែងជួប:
- កាហ្វេ $2 × ៣០ថ្ងៃ = $60/ខែ = $720/ឆ្នាំ!
- Grab $5 × ១៥ដង = $75/ខែ
- ការជាវមិនប្រើ = $20/ខែ

សរុប: ខាតបង់ដោយមិនដឹងខ្លួន $155/ខែ = $1,860/ឆ្នាំ!

🔍 ចំណុចដែលលុយលេចធ្លាយទាំង ៥ ប្រភេទសំខាន់ៗនៅកម្ពុជា:

1️⃣ ចំណុចលេចធ្លាយឌីជីថល (Digital Leaks - ការជាវអនឡាញ)
• Netflix, Spotify ពី $5-15/ខែ
• ហ្គេម (PUBG UC, Free Fire) ពី $10-30/ខែ
• កម្មវិធី Premium ដែលមិនប្រើ ពី $3-10/ខែ
• ប្រើ 4G លើសកញ្ចប់ដែលបានទិញ ពី $5-20/ខែ

2️⃣ ចំណុចលេចធ្លាយពីភាពងាយស្រួល (Convenience Leaks - ចំណាយដើម្បីភាពងាយស្រួល)
• ថ្លៃដឹកជញ្ជូនអាហារ (Food Delivery fees) ពី $20-40/ខែ
• Grab ចម្ងាយខ្លី ពី $50/ខែ
• តាក់ស៊ីដោយមិនចាំបាច់ ពី $30+/ខែ

3️⃣ ចំណុចលេចធ្លាយពីការទិញភ្លាមៗ (Impulse Leaks - ចំណាយភ្លាមៗ)
• ឃើញការបញ្ចុះតម្លៃក៏ទិញភ្លាម
• ទិញទំនិញ "promotion" ដែលថោក តែមិនត្រូវការ
• ការទិញទំនិញពេលមានអារម្មណ៍មិនល្អ
• ការទិញតាម Facebook ads សរុប $30-80/ខែ

4️⃣ ចំណុចលេចធ្លាយពីបណ្តាញសង្គម (Social Leaks - ចំណាយសង្គម)
• KTV, Bar, Club ពី $20-50/ដង
• ការទិញស្រាបៀរលើសកំណត់ ពី $10-30/ខែ
• ការចំណាយហួសហេតុក្នុងក្រុមមិត្តភក្តិ ពី $40-100/ខែ

5️⃣ ចំណុចលេចធ្លាយតូចៗ (Micro Leaks - ចំណាយតូចៗ)
• កាហ្វេហាង ពី $40/ខែ
• ការទិញអាហារសម្រន់ផ្សេងៗ ពី $30/ខែ
• ភេសជ្ជៈ (ទឹកកក/ទឹកផ្សេងៗ) ពី $15/ខែ
• ការជួយអ្នកដទៃញឹកញាប់ ពី $20-60/ខែ

---

🎯 ផែនការសកម្មភាពថ្ងៃនេះ:

✅ ជំហានទី១ - ការកំណត់អត្តសញ្ញាណចំណុចលេចធ្លាយកម្រិតខ្ពស់
→ ធ្វើតាមប្រព័ន្ធ ៣០ នាទីខាងលើ
→ កត់ត្រារាល់ចំណុចលេចធ្លាយដែលរកឃើញទាំងអស់

✅ ជំហានទី២ - កំណត់អាទិភាពនៃការកាត់បន្ថយ
→ មួយណាត្រូវកាត់បន្ថយភ្លាមៗ (ចំណាយច្រើន + មិនចាំបាច់)
→ មួយណាត្រូវកាត់បន្ថយបន្តិចម្ដងៗ (ចំណាយមធ្យម + អាចកាត់បាន)

✅ ជំហានទី៣ - អនុវត្តសកម្មភាពបញ្ឈប់ចំណុចលេចធ្លាយ
→ បោះបង់ការជាវដែលមិនចាំបាច់ភ្លាមៗ!
→ ដាក់ការព្រមានសម្រាប់ចំណុចជំរុញការចំណាយ (spending triggers)
→ បង្កើតជម្រើសដែលមានតម្លៃថោកជាង

🎯 យុទ្ធសាស្ត្រ ៤ យ៉ាងដើម្បីបិទចំណុចលេចធ្លាយលុយ:

1️⃣ ច្បាប់ ២៤ ម៉ោង (The 24-Hour Rule)
មុនពេលសម្រេចចិត្តទិញអ្វីដែលលើសពី $20 → ត្រូវរង់ចាំ ២៤ ម៉ោង (ដើម្បីជៀសវាងការចំណាយដោយអារម្មណ៍)

2️⃣ ពិនិត្យការជាវឡើងវិញ (Subscription Review)
រាល់ខែត្រូវឧស្សាហ៍ពិនិត្យការជាវទាំងអស់ម្តងទៀត

3️⃣ ការកំណត់ប្រាក់ចំណាយសម្រាប់កម្សាន្ត (Cash Allowance)
ដកសាច់ប្រាក់ចំនួនកំណត់ សម្រាប់តែការកម្សាន្តប៉ុណ្ណោះ

4️⃣ យុទ្ធសាស្ត្ររកជម្រើសជំនួស (Substitute Strategy)
រកជម្រើសដែលមានតម្លៃធូរថ្លៃជាង:
• ធ្វើកាហ្វេនៅផ្ទះ > ទិញកាហ្វេហាង
• ធ្វើម្ហូបនៅផ្ទះ > បញ្ជាម្ហូបមកផ្ទះ
• ជិះម៉ូតូ/ឡានផ្ទាល់ខ្លួន > ជិះ Taxi Grab

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើចំណុចលេចធ្លាយលុយណាខ្លះដែលធ្វើឱ្យខ្ញុំភ្ញាក់ផ្អើលបំផុត?"
២. "តើចំណាយណាដែលកើតឡើងដោយសារអារម្មណ៍ (ស្ត្រេស, ធុញថប់, ក្រៀមក្រំ)?"
៣. "បើសិនជាខ្ញុំអាចសន្សំបាន $50/ខែ ឬលើសពីនេះ តើខ្ញុំនឹងយកទៅប្រើប្រាស់ធ្វើអ្វី?"

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីចំណុចតូចបំផុត - កាត់បន្ថយចំណុចលេចធ្លាយលុយតែ ២-៣ យ៉ាងមុនសិន
• រកជម្រើសជំនួស - កុំបញ្ឈប់ទាំងស្រុង តែរកជម្រើសដែលថោកជាង
• តាមដានលទ្ធផលដែលទទួលបាន - កត់ត្រាប្រាក់សន្សំបានរាល់សប្តាហ៍
• ផ្តល់រង្វាន់ដល់ខ្លួនឯង - ប្រើ ២០% នៃប្រាក់សន្សំដើម្បីទិញអ្វីដែលអ្នកពិតជាចង់បាន
• អនុវត្តភ្លាមៗ - កុំពន្យារពេលក្នុងការកំណត់អត្តសញ្ញាណចំណុចលេចធ្លាយ!

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមអនុវត្តយុទ្ធសាស្ត្រទាំង ៤ នេះ
- កត់ត្រាចំណាយជារៀងរាល់ថ្ងៃ
- ត្រូវសង្កេតមើលអារម្មណ៍របស់អ្នកនៅពេលចង់ចំណាយ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: រកបាន $50+ ថ្ងៃនេះ → ទទួលបាន "ឧបករណ៍ត្រួតពិនិត្យចំណុចលេចធ្លាយលុយកម្រិតខ្ពស់នៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 2 COMPLETE - បិទលេច $____/ខែ" + ចែករំលែកការសន្សំបានប៉ុន្មាន!

ស្អែកយើងនឹងវាយតម្លៃ "ប្រព័ន្ធគ្រប់គ្រងលុយបច្ចុប្បន្ន" របស់អ្នក ជាមួយ Personal Finance Health Check!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day3`,

   3: `🔱 ថ្ងៃទី ៣: ការពិនិត្យសុខភាពហិរញ្ញវត្ថុផ្ទាល់ខ្លួន - ដឹងពីសុខភាពលុយក្នុង ១៥ នាទី! 🔱

🔥 គោលដៅថ្ងៃនេះ: ទទួលបានពិន្ទុសុខភាពហិរញ្ញវត្ថុផ្ទាល់ខ្លួន + កែលម្អតាមលទ្ធភាពខ្លួនឯង!

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃមុនៗអ្នកបានរកលុយ $30+ និងបិទចំណុចលេចធ្លាយលុយ $50+ រួចហើយ។ ថ្ងៃនេះយើងនឹងពិនិត្យមើលសុខភាពហិរញ្ញវត្ថុទាំងមូលរបស់អ្នក!

💎 ប្រព័ន្ធត្រួតពិនិត្យសុខភាពហិរញ្ញវត្ថុ (១៥ នាទី)

⚡ ជំហានទី១ (៥ នាទី): ការវាយតម្លៃការតាមដានលុយ
→ បើកកម្មវិធីដែលអ្នកប្រើដើម្បីតាមដានចំណាយ (សៀវភៅកត់ត្រា ឬ ទូរស័ព្ទ)
→ មើលថាអ្នកបានកត់ត្រាចំណាយអស់ប៉ុន្មានថ្ងៃក្នុង ១ សប្តាហ៍

បើអ្នកកត់ត្រា:
• ៧ ថ្ងៃ = A+
• ៥-៦ ថ្ងៃ = B
• ៣-៤ ថ្ងៃ = C
• ១-២ ថ្ងៃ = D
• ០ ថ្ងៃ = F

💡 ការពិតនៃការតាមដាននៅកម្ពុជា:
• កត់ត្រាទាំងអស់: មានតែ 5% នៃអ្នកប្រើប្រាស់នៅកម្ពុជា
• កត់ត្រាចំណាយធំ: 25% នៃអ្នកប្រើប្រាស់
• កត់ត្រាម្តងម្កាល: 45% នៃអ្នកប្រើប្រាស់
• មិនកត់ត្រាទាល់តែសោះ: 25% នៃអ្នកប្រើប្រាស់

⚡ ជំហានទី២ (៥ នាទី): ការវាយតម្លៃផែនការលុយ
→ តើអ្នកដឹងថាខែក្រោយនឹងចំណាយប៉ុន្មានទេ?
→ តើអ្នកមានផែនការសម្រាប់ចំណាយធំៗទេ?

បើអ្នកមានផែនការ:
• ដឹងច្បាស់ = A
• ដឹងប្រហែល = B
•  មិនច្បាស់ = C
• មិនដឹង = F

💡 ការពិតនៃការរៀបចំផែនការនៅកម្ពុជា:
• មានផែនការច្បាស់: 15% នៃអ្នកប្រើប្រាស់
• ផែនការមិនច្បាស់: 35% នៃអ្នកប្រើប្រាស់
• មិនមានផែនការ: 50% នៃអ្នកប្រើប្រាស់

⚡ ជំហានទី៣ (៥ នាទី): ការវាយតម្លៃការត្រៀមលក្ខណៈបន្ទាន់
→ បើអ្នកឈប់ការងារ អ្នកអាចរស់នៅបានប៉ុន្មានខែ?
→ តើអ្នកមានលុយបន្ទាន់ដាច់ដោយឡែកទេ?

បើឈប់ការងារអ្នកអាចរស់នៅបាន:
• ៦+ ខែ = A+
• ៣-៦ ខែ = A
• ១-៣ ខែ = B
• < ១ ខែ = C
• គ្មាន = F

💡 ការពិតមូលនិធិបន្ទាន់នៅកម្ពុជា:
• មានលុយបន្ទាន់ ៦+ ខែ: 8% នៃអ្នកប្រើប្រាស់
• មានលុយបន្ទាន់ ១-៦ ខែ: 22% នៃអ្នកប្រើប្រាស់
• មានលុយបន្ទាន់ < ១ ខែ: 35% នៃអ្នកប្រើប្រាស់
• គ្មានលុយបន្ទាន់: 35% នៃអ្នកប្រើប្រាស់

📊 ម៉ាស៊ីនគណនាសុខភាពហិរញ្ញវត្ថុ:
Tracking Grade: ____
Planning Grade: ____
Emergency Grade: ____

Grade និង ពិន្ទុ:
A+ = 4 ពិន្ទុ | A = 3.5 ពិន្ទុ | B = 3 ពិន្ទុ | C = 2 ពិន្ទុ | D = 1 ពិន្ទុ | F = 0 ពិន្ទុ
សរុបពិន្ទុ: ____/12 = ____%

🏆 ការធានា: មិនអាចកែលម្អបាន ២០+ ពិន្ទុក្នុង ៧ ថ្ងៃ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការប្រឹក្សាឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យ Health Check (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 អ្នកស្រី សុមាលី (២៧ ឆ្នាំ, ហាងលក់សម្លៀកបំពាក់, ភ្នំពេញ):
"ពី Score 35% ទៅ 85% ក្នុង ១០ ថ្ងៃ! ខ្ញុំចាប់ផ្តើមកត់ត្រា + សន្សំបន្ទាន់ $200 + រៀបចំផែនការខែនីមួយៗ!"

👤 លោក ភក្ត្រ (៣៣ ឆ្នាំ, អ្នកបើកបរ, កំពត):
"Score ដំបូង F (25%) ឥឡូវ B+ (75%)! ខ្ញុំយល់ពីប្រាក់បន្ទាន់ + ប្រើ app កត់ត្រា = ជីវិតស្រួលជាង!"

👤 អ្នកស្រី រតនា (២៩ ឆ្នាំ, គ្រូបង្រៀន, បាត់ដំបង):
"Health Check បានបង្ហាញខ្ញុំថាខ្វះការរៀបចំផែនការ! ឥឡូវធ្វើ Budget ប្រចាំខែ + មាន Emergency Fund = Score ឡើង 60%!"

---

📊 ពិនិត្យ ៣ ផ្នែកសំខាន់ៗ:

1️⃣ TRACKING (ការតាមដាន)
🔍 តើអ្នកបានតាមដានលុយចូល-ចេញដោយរបៀបណា?

📱 ជម្រើសទូទៅដែលអ្នកអាចតាមដានបាន:
• កម្មវិធីនៅកម្ពុជា: Khmer Money Manager, Money Lover
• កម្មវិធីអន្តរជាតិ: Spendee, Mint (ត្រូវប្រើ VPN)
• Excel/Google Sheet (ឥតគិតថ្លៃ)
• សៀវភៅសរសេរដៃ (បុរាណតែល្អ)
• ABA/ACLEDA mobile apps (សម្រាប់មើលប្រវត្តិប្រតិបត្តិការ)

2️⃣ BUDGETING (ការបែងចែកលុយ)
💰 តើអ្នកមានការបែងចែកលុយសម្រាប់ការប្រើប្រាស់ដែរឬទេ?

📊 ប្រភេទថវិកាទូទៅ:
• ក្បួន 50/30/20: ចាំបាច់ 50%, ចង់បាន 30%, សន្សំ 20%
• ក្បួន Pay Yourself First: សន្សំមុន, ចំណាយក្រោយ
• Zero-Based Budget: គ្រប់ដុល្លារមានមុខងារច្បាស់លាស់
• Free Spending: ចំណាយតាមចិត្ត (មិនសូវជាវិធីល្អទេ)

3️⃣ SAVING (ការសន្សំ)
💎 តើអ្នកសន្សំលុយបានល្អឬទេ?

🏦 ប្រភេទការសន្សំ:
• Emergency Fund: សន្សំសម្រាប់ពេលបន្ទាន់ (ស្មើនឹង 3-6 ខែនៃការចំណាយ)
• Goal-Based: សន្សំសម្រាប់គោលដៅជាក់លាក់ (ដូចជាទិញម៉ូតូ, ទិញផ្ទះ)
• Auto-Save: ដាក់ការសន្សំដោយស្វ័យប្រវត្តិ (ដូចជា ABA Dream Saving)

🎯 ផែនការសកម្មភាពដើម្បីកែលម្អភ្លាមៗ:

✅ បើ Score F-D (០-៥០%): របៀបបន្ទាន់ (EMERGENCY MODE)
→ ចាប់ផ្តើមកត់ត្រាចំណាយធំៗឥឡូវនេះ
→ បង្កើតមូលនិធិបន្ទាន់ (Emergency Fund) ចំនួន $50 ពីលុយដែលរកបានពីថ្ងៃមុន
→ ប្រើវិធីសាស្ត្រសាមញ្ញ: សៀវភៅតូចមួយ + ប៊ិច

✅ បើ Score C (៥០-៦៥%): របៀបកែលម្អ (IMPROVEMENT MODE)
→ ប្តូរទៅប្រើកម្មវិធីកត់ត្រា (ដូចជា Khmer Money Manager)
→ បង្កើនមូលនិធិបន្ទាន់ទៅ $200
→ ចាប់ផ្តើមធ្វើផែនការមូលដ្ឋានប្រចាំខែ

✅ បើ Score B (៦៥-៨០%): របៀបបង្កើនប្រសិទ្ធភាព (OPTIMIZATION MODE)
→ ធ្វើថវិកាលម្អិតប្រចាំខែ (Detailed Budget Monthly)
→ បង្កើនមូលនិធិបន្ទាន់ទៅដល់ ៣ ខែនៃការចំណាយ
→ ដាក់គោលដៅសន្សំជាក់លាក់ (ទិញម៉ូតូ, ទិញផ្ទះ)

✅ បើ Score A (៨០%+): របៀបគ្រប់គ្រងជំនាញ (MASTERY MODE)
→ ធ្វើផែនការវិនិយោគ (Investment Planning)
→ បង្កើនប្រភពចំណូល
→ ជួយអ្នកដទៃកែលម្អសុខភាពហិរញ្ញវត្ថុរបស់ពួកគេ

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តាមរយៈការពិនិត្យសុខភាពនេះ តើខ្ញុំស្ថិតក្នុងកម្រិតណា?"
២. "អ្វីជាចំណុចខ្សោយធំបំផុតរបស់ខ្ញុំដែលត្រូវកែលម្អ?"
៣. "តើខ្ញុំអាចធ្វើអ្វីខ្លះភ្លាមៗដើម្បីកែលម្អ ២០ ពិន្ទុ?"

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីចំណុចខ្សោយបំផុត - កែលម្អត្រឹមតែ ១ ផ្នែកមុនសិន
• ប្រើប្រាស់វិធីសាស្ត្រងាយស្រួល - កុំធ្វើឱ្យស្មុគស្មាញ
• តាមដានលទ្ធផល - ពិនិត្យមើលពិន្ទុរៀងរាល់សប្តាហ៍
• អនុវត្តភ្លាមៗ - កុំរង់ចាំថ្ងៃល្អ!

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមអនុវត្តផែនការសកម្មភាពតាម Grade ដែលបានកំណត់
- ពិសោធន៍ជាមួយនឹងវិធីសាស្ត្រថ្មីៗ
- ត្រៀមខ្លួនសម្រាប់ Income & Cost Mapping

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទាក់ @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: កែលម្អ Score ២០+ ពិន្ទុ → ទទួលបាន "ទម្រង់សម្រាប់តាមដានហិរញ្ញវត្ថុផ្ទាល់ខ្លួននៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 3 COMPLETE - Score ___% → Grade ___" + ចែករំលែកផែនការសកម្មភាពរបស់អ្នក!

ស្អែកយើងនឹងបង្កើតផែនទីចំណូលចំណាយ "Income & Cost Map" ពេញលេញ ដើម្បីមើលលំហូរលុយបានច្បាស់!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day4`,

   4: `🔱 ថ្ងៃទី ៤: ម៉ាស៊ីនគណនាលំហូរលុយ - ដឹងលំហូរលុយពិតក្នុង ១០ នាទី! 🔱

🔥 គោលដៅថ្ងៃនេះ: ស្គាល់គំរូលំហូរលុយពិតប្រាកដ + កំណត់ទិសដៅកែលម្អច្បាស់លាស់!

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃមុនៗអ្នកបានបង្កើនប្រសិទ្ធភាពលំហូរលុយរួចហើយ។ ថ្ងៃនេះយើងនឹងគណនាលំហូរលុយពិតប្រាកដរបស់អ្នក!

💎 ម៉ាស៊ីនគណនាលំហូរលុយតាមពេលវេលាពិត (១០ នាទី)

⚡ ជំហានទី១ (៥ នាទី): ពិនិត្យប្រភពចំណូលនៅកម្ពុជា
→ កត់ត្រាចំណូលរបស់អ្នកទាំងអស់ (មើលបង្កាន់ដៃខែចុងក្រោយ)
→ បែងចែកតាមប្រភេទខាងក្រោម
→ គណនាចំណូលសរុបក្នុង ១ ខែ

💡 ប្រភពចំណូលនៅកម្ពុជា (ឧទាហរណ៍ពិត):
• ការងារចម្បង: $300-800/ខែ (ការងារការិយាល័យ)
• ការងារក្រៅម៉ោងពេលល្ងាច: $100-300/ខែ (បង្រៀន, បកប្រែ)
• អាជីវកម្មអនឡាញ: $50-500/ខែ (ហាង Facebook, TikTok Shop)
• អ្នកបើកបរ Grab/PassApp: $200-600/ខែ
• សេវាកម្ម Freelance: $100-400/ខែ (រចនា, សរសេរ)

⚡ ជំហានទី២ (៥ នាទី): ពិនិត្យការចំណាយនៅកម្ពុជា
→ កត់ត្រាចំណាយរបស់អ្នកទាំងអស់ (មើល Bank Statement)
→ បែងចែកតាមប្រភេទខាងក្រោម
→ គណនាចំណាយសរុបក្នុង ១ ខែ

💡 ប្រភេទចំណាយនៅកម្ពុជា (តួលេខពិត):
• ជួលផ្ទះ/បន្ទប់: $80-300/ខែ (នៅស្រុក vs នៅភ្នំពេញ)
• ម្ហូបអាហារ: $120-250/ខែ (ធ្វើនៅផ្ទះ + ញ៉ាំខាងក្រៅ)
• ការធ្វើដំណើរ: $30-80/ខែ (ម៉ូតូ, សាំង, Grab)
• ទូរស័ព្ទ + អ៊ីនធឺណែត: $15-40/ខែ
• សំលៀកបំពាក់: $20-60/ខែ
• កម្សាន្ត: $50-150/ខែ (KTV, កាហ្វេ, ភាពយន្ត)

📊 ម៉ាស៊ីនគណនាលំហូរលុយ - គណនាភ្លាមៗ:

Income Calculator:
- ការងារចម្បង: $____/ខែ
- ការងារក្រៅម៉ោង/ការងារបន្ថែម: $____/ខែ
- ចំណូលពីអាជីវកម្មអនឡាញ: $____/ខែ
- ប្រភពផ្សេងទៀត: $____/ខែ
សរុបចំណូល: $____/ខែ

Expense Calculator:
- ជួលផ្ទះ + ថ្លៃទឹកភ្លើង: $____/ខែ
- ម្ហូបអាហារ: $____/ខែ
- ការធ្វើដំណើរ: $____/ខែ
- កម្សាន្ត: $____/ខែ
- ចំណាយផ្សេងទៀត: $____/ខែ
សរុបចំណាយ: $____/ខែ

💰 លទ្ធផលលំហូរលុយ:
ចំណូល $____ - ចំណាយ $____ = $___ (+ វិជ្ជមាន / - អវិជ្ជមាន)

🏆 ការធានា: មិនអាចកែលម្អលំហូរលុយ ១៥% ក្នុង ៧ ថ្ងៃ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការប្រឹក្សាឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យការបង្កើនប្រសិទ្ធភាពលំហូរលុយ (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 អ្នកស្រី លីហួរ (២៦ ឆ្នាំ, គណនេយ្យករ, ភ្នំពេញ):
"លំហូរលុយដំបូង: ចំណូល $450 - ចំណាយ $480 = -$30! ខ្ញុំបានធ្វើតាមគន្លឹះរកបានចំណូលបន្ថែម $150 = ឥឡូវ +$120/ខែ!"

👤 លោក សុខា (៣១ ឆ្នាំ, mechanic, កំពត):
"ចំណូល $380 - ចំណាយ $420 = -$40។ ខ្ញុំបានបិទការជាវដែលមិនចាំបាច់ + កាត់បន្ថយការកម្សាន្ត = ឥឡូវ +$85/ខែ + មានមូលនិធិបន្ទាន់ហើយ!"

👤 អ្នកស្រី ចន្ទ្រា (២៤ ឆ្នាំ, online seller, បាត់ដំបង):
"ការវិភាគលំហូរលុយបង្ហាញពីគំរូ: ខ្ញុំចំណាយច្រើននៅពេលមានអារម្មណ៍តានតឹង! ឥឡូវខ្ញុំត្រួតពិនិត្យការចំណាយតាមអារម្មណ៍ = សន្សំបាន $180/ខែ!"

---

💰 ផ្នែកទី១: ប្រភពចំណូល (Income Sources)

🏢 ចំណូលចម្បង:
• ប្រាក់ខែ/ប្រាក់ឈ្នួលប្រចាំថ្ងៃពីការងារ
• ចំណូលពីអាជីវកម្មផ្ទាល់ខ្លួន
• ចំណូលពីការធ្វើការដោយខ្លួនឯង

💼 ចំណូលបន្ថែម:
• ការងារក្រៅម៉ោង (Part-time)
• ការងារឯករាជ្យ (Freelancing)
• ការលក់ផលិតផលបន្ថែម
• ការបង្រៀនឯកជន
• ការដឹកជញ្ជូន (Grab, PassApp)

💎 ចំណូលស្វ័យប្រវត្តិ:
• ការប្រាក់ធនាគារ
• ប្រាក់ចំណេញពីការវិនិយោគ
• ចំណូលពីការជួលផ្ទះ/បន្ទប់
• ចំណូលពីអាជីវកម្មស្វ័យប្រវត្តិ

💸 ផ្នែកទី២: ប្រភពចំណាយ (Expense Categories)

🏠 ចំណាយស្ថិរភាព (រៀងរាល់ខែ):
• ថ្លៃជួលផ្ទះ/បន្ទប់
• ថ្លៃទឹក, ភ្លើង, អ៊ីនធឺណែត
• ធានារ៉ាប់រង
• ថ្លៃកម្ចីប្រចាំខែ

🍽️ ចំណាយអថេរ (ប្រែប្រួលតាមការប្រើប្រាស់):
• ថ្លៃម្ហូបអាហារ (ធ្វើនៅផ្ទះ + ញ៉ាំខាងក្រៅ)
• ការធ្វើដំណើរ (សាំង, តាក់ស៊ី)
• កម្សាន្ត
• សំលៀកបំពាក់
• ថែទាំសុខភាព

🛠️ ចំណាយម្តងម្កាល:
• ជួសជុលផ្ទះ/ម៉ូតូ/ឡាន
• ការចូលរួមពិធីបុណ្យផ្សេងៗ
• ការជួយឧបត្ថម្ភគ្រួសារ
• ថ្លៃអប់រំ

🎯 សកម្មភាពបង្កើនប្រសិទ្ធភាពលំហូរលុយភ្លាមៗ:

✅ បើលំហូរលុយអវិជ្ជមាន (-):
→ កាត់បន្ថយចំណាយធំបំផុត ២០% ភ្លាមៗ
→ រកប្រភពចំណូលបន្ថែម ១ មុខក្នុង ៧ ថ្ងៃ
→ អនុវត្តរបៀបបន្ទាន់ - តាមដានគ្រប់ចំណាយទាំងអស់

✅ បើលំហូរលុយតិច (០-១០%):
→ កាត់បន្ថយចំណាយមិនចាំបាច់ ១៥%
→ បង្កើនប្រសិទ្ធភាពចំណាយធំៗ (ផ្ទះ, ម្ហូប, ការធ្វើដំណើរ)
→ បង្កើនចំណូលតាមជំនាញដែលអ្នកមាន

✅ បើលំហូរលុយល្អ (១០%+):
→ ធ្វើឱ្យដំណើរការសន្សំមានលក្ខណៈស្វ័យប្រវត្តិ
→ បង្កើនមូលនិធិបន្ទាន់ទៅដល់ ៣-៦ ខែនៃការចំណាយ
→ ចាប់ផ្តើមវិនិយោគលើជំនាញ/អាជីវកម្ម

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើលំហូរលុយរបស់ខ្ញុំវិជ្ជមាន ឬ អវិជ្ជមាន?"
២. "តើចំណាយធំបំផុតរបស់ខ្ញុំគឺអ្វីខ្លះ? ហើយតើខ្ញុំអាចកាត់បន្ថយវាបានទេ?"
៣. "តើខ្ញុំអាចបង្កើនចំណូលតាមរបៀបណាភ្លាមៗ?"
៤. "តើខ្ញុំចំណាយលុយលើអារម្មណ៍ (emotional spending) ប៉ុន្មាន?"

🎉 គន្លឹះជោគជ័យ:

• ត្រូវតែស្ថិតក្នុងការពិត - កុំលាក់បាំង ឬ កុហកអំពីចំណាយពិតប្រាកដ
• ចាប់ផ្តើមពីចំណុចធំបំផុត - កែលម្អការចំណាយធំៗមុនចំណាយតូចៗ
• តាមដានគំរូ - កត់សម្គាល់ថាអ្នកចំណាយច្រើននៅពេលណា/អារម្មណ៍ណា
• កែលម្អជាជំហានៗ - កុំព្យាយាមផ្លាស់ប្តូរអ្វីទាំងអស់ភ្លាមៗ

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមអនុវត្តសកម្មភាពបង្កើនប្រសិទ្ធភាពតាមលទ្ធផលលំហូរលុយរបស់អ្នក
- សង្កេតមើលគំរូចំណាយផ្ទាល់ខ្លួន
- ត្រៀមខ្លួនចាត់ចែងចំណាយទៅជា Survival vs Growth categories

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: កែលម្អលំហូរលុយ ១៥%+ → ទទួលបាន "មគ្គុទេសក៍បង្កើនប្រសិទ្ធភាពចំណូលនៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 4 COMPLETE - Flow: $___" + ចែករំលែកផែនការបង្កើនប្រសិទ្ធភាពរបស់អ្នក!

ស្អែកយើងនឹងចាត់ចែងចំណាយទៅ "Survival vs Growth" ដើម្បីកំណត់អាទិភាពជីវិតរបស់អ្នក!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day5`,

   5: `🔱 ថ្ងៃទី ៥: ឧបករណ៍វិភាគតុល្យភាពចំណាយ - ដឹងតុល្យភាពចំណាយក្នុង 15 នាទី! 🔱

🔥 គោលដៅថ្ងៃនេះ: វិភាគតុល្យភាព ការរស់រានធៀបនឹងការលូតលាស់ធៀបនឹងរបៀបរស់នៅ + បង្កើតផែនការសកម្មភាពស្មោះត្រង់!

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃមុនៗអ្នកបានបង្កើនប្រសិទ្ធភាពលំហូរលុយរួចហើយ។ ថ្ងៃនេះយើងនឹងវិភាគថាតើអ្នកចំណាយលុយសម្រាប់អ្វីខ្លះ - ការរស់រាន, ការលូតលាស់, ឬ របៀបរស់នៅ?

💎 ឧបករណ៍វិភាគប្រភេទចំណាយភ្លាមៗ (១៥ នាទី)

⚡ ជំហានទី១ (៥ នាទី): ពិនិត្យចំណាយសម្រាប់ការរស់រាននៅកម្ពុជា
→ មើល Bank statement/ចំណាយចុងក្រោយរបស់អ្នក
→ កត់ត្រាចំណាយដែលចាំបាច់ដើម្បីរស់រាន
→ គណនាភាគរយនៃចំណាយសម្រាប់ការរស់រាន

💡 ឧទាហរណ៍ចំណាយសម្រាប់ការរស់រាននៅកម្ពុជា (ចាំបាច់ពិតប្រាកដ):
• ជួលផ្ទះ/បន្ទប់: $80-300/ខែ
• ម្ហូបចាំបាច់ (ទិញពីផ្សារ, ធ្វើនៅផ្ទះ): $80-150/ខែ
• ការធ្វើដំណើរទៅធ្វើការ: $20-60/ខែ
• ថ្លៃទឹក + ភ្លើង + អ៊ីនធឺណែត: $15-40/ខែ
• ថ្នាំពេទ្យចាំបាច់: $10-30/ខែ
• សំលៀកបំពាក់មូលដ្ឋាន: $15-40/ខែ

⚡ ជំហានទី២ (៥ នាទី): ពិនិត្យការវិនិយោគសម្រាប់ការលូតលាស់នៅកម្ពុជា
→ កត់ត្រាចំណាយដែលជួយអ្នកលូតលាស់
→ តើមានចំណាយសម្រាប់ការលូតលាស់ប៉ុន្មាន?
→ គណនាភាគរយនៃការវិនិយោគសម្រាប់ការលូតលាស់

💡 ឧទាហរណ៍ការវិនិយោគសម្រាប់ការលូតលាស់នៅកម្ពុជា (វិនិយោគលើខ្លួនឯង):
• វគ្គសិក្សាអនឡាញ (Coursera, Udemy): $10-50/ខែ
• សៀវភៅ + សម្ភារៈសិក្សា: $5-20/ខែ
• សមាជិកភាព Gym/ការហាត់ប្រាណ: $10-30/ខែ
• រៀនភាសាបរទេស: $20-80/ខែ
• ឧបករណ៍សម្រាប់ធ្វើការ (laptop, tools): $20-100/ខែ
• ព្រឹត្តិការណ៍បង្កើតទំនាក់ទំនង/សន្និសីទ: $10-50/ខែ
• ការចាប់ផ្តើមអាជីវកម្មតូច (side business): $30-200/ខែ

⚡ ជំហានទី៣ (៥ នាទី): ពិនិត្យចំណាយសម្រាប់របៀបរស់នៅនៅកម្ពុជា
→ កត់ត្រាចំណាយសម្រាប់ការកម្សាន្ត និងរបស់ប្រណីត
→ តើចំណាយលើរបស់ដែលចង់បានធៀបនឹងតម្រូវការប៉ុន្មាន?
→ គណនាភាគរយនៃចំណាយសម្រាប់របៀបរស់នៅ

💡 ឧទាហរណ៍ចំណាយសម្រាប់របៀបរស់នៅនៅកម្ពុជា (ចង់បាន តែមិនចាំបាច់):
• KTV, Bar, Club: $30-150/ខែ
• កាហ្វេហាង (Brown, Amazon): $25-80/ខែ
• ញ៉ាំអាហារនៅហាងថ្លៃ (restaurants): $40-120/ខែ
• ការទិញទូរស័ព្ទ/ឧបករណ៍ថ្មី: $20-200/ខែ
• សំលៀកបំពាក់ម៉ូដ: $30-150/ខែ
• ការធ្វើដំណើរកម្សាន្ត: $50-300/ខែ
• ការទិញទំនិញភ្លាមៗ (Shopping Impulse): $20-100/ខែ

📊 ម៉ាស៊ីនគណនាតុល្យភាពចំណាយ:

ចំណាយសម្រាប់ការរស់រាន (Survival Spending):
- ជួលផ្ទះ + ថ្លៃទឹកភ្លើង: $____
- ម្ហូបចាំបាច់: $____
- ការធ្វើដំណើរទៅធ្វើការ: $____
- ថ្នាំពេទ្យ + តម្រូវការមូលដ្ឋាន: $____
សរុបចំណាយសម្រាប់ការរស់រាន: $____ = ___% នៃចំណាយសរុប

ការវិនិយោគសម្រាប់ការលូតលាស់ (Growth Investment):
- ការអប់រំ/វគ្គសិក្សា: $____
- ការអភិវឌ្ឍជំនាញ: $____
- សុខភាព/ការហាត់ប្រាណ: $____
- ការវិនិយោគអាជីវកម្ម: $____
សរុបចំណាយសម្រាប់ការលូតលាស់: $____ = ___% នៃចំណាយសរុប

ចំណាយសម្រាប់របៀបរស់នៅ (Lifestyle Spending):
- ការកម្សាន្ត: $____
- ការញ៉ាំអាហារនៅខាងក្រៅប្រណីត: $____
- ការទិញទំនិញដែលចង់បាន: $____
- ការកម្សាន្តផ្សេងៗ: $____
សរុបចំណាយសម្រាប់របៀបរស់នៅ: $____ = ___% នៃចំណាយសរុប

🎯 គោលដៅតុល្យភាពដ៏ល្អ:
• ការរស់រាន (Survival): 50-65% (ចាំបាច់)
• ការលូតលាស់ (Growth): 20-30% (វិនិយោគ)
• របៀបរស់នៅ (Lifestyle): 10-25% (កម្សាន្ត)

🏆 ការធានា: មិនអាចរៀបចំតុល្យភាពចំណាយ ១៥% ក្នុង ១០ ថ្ងៃ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការប្រឹក្សាឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យតុល្យភាពចំណាយ (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 អ្នកស្រី មុន្នី (២៥ ឆ្នាំ, រៀនកម្មវិធី, ភ្នំពេញ):
"ដំបូង: ការរស់រាន 80%, ការលូតលាស់ 5%, របៀបរស់នៅ 15%។ ឥឡូវ: 60%, 25%, 15%! ខ្ញុំចាប់ផ្តើមវគ្គសិក្សាអនឡាញ + សន្សំបានហើយ!"

👤 លោក ពិសិដ្ឋ (២៩ ឆ្នាំ, mechanic, កំពត):
"ការវិភាគចំណាយបង្ហាញថាចំណាយលើរបៀបរស់នៅ 45%! ខ្ញុំបានកាត់បន្ថយការទៅ KTV + កាហ្វេ = ចាប់ផ្តើមវគ្គសិក្សាផ្សារដែក។ ឥឡូវចំណូលខ្ញុំកើន 40%!"

👤 អ្នកស្រី សុភាព (៣២ ឆ្នាំ, ម្ចាស់ហាង, បាត់ដំបង):
"តុល្យភាពដំបូង: ការរស់រាន 70%, ការលូតលាស់ 10%, របៀបរស់នៅ 20%។ ឥឡូវបានកែទៅ 55%, 30%, 15% = អាជីវកម្មរីកចម្រើន + ប្រាក់ចំណេញកើនឡើង!"

---

🎯 ការយល់ដឹងសំខាន់:
ចំណាយមាន ៣ ប្រភេទសំខាន់ៗគឺ៖ ការរស់រាន, ការលូតលាស់, និងរបៀបរស់នៅ។

🏠 ក្រុមទី១: ការរស់រាន (SURVIVAL)
ចំណាយដែលចាំបាច់ដើម្បីឱ្យអ្នកអាចរស់នៅបានជាមូលដ្ឋាន

🔴 ឧទាហរណ៍ចំណាយសម្រាប់ការរស់រាន:
• ម្ហូបអាហារ (ធ្វើនៅផ្ទះ, ទិញតាមផ្សារ)
• ផ្ទះសម្បែង (ជួលផ្ទះ, សងកម្ចីផ្ទះ)
• ការធ្វើដំណើរចាំបាច់ (ទៅធ្វើការ)
• ការថែទាំសុខភាពចាំបាច់ (ថ្នាំព្យាបាលជំងឺ)
• ប្រាក់ធានារ៉ាប់រង (ជីវិត, សុខភាព)
• ថ្លៃទឹក, ភ្លើង, អ៊ីនធឺណែត

🚀 ក្រុមទី២: ការលូតលាស់ (GROWTH)
ចំណាយដែលជួយអ្នកឱ្យកាន់តែរីកចម្រើន និងកាន់តែប្រសើរឡើង

🟢 ឧទាហរណ៍ចំណាយសម្រាប់ការលូតលាស់:
• ការអប់រំ និងជំនាញ (វគ្គសិក្សា, សៀវភៅ)
• ការវិនិយោគ (ហ៊ុន, ប្រាក់បញ្ញើ)
• ការថែទាំសុខភាព ឬ ការបង្ការ (ពិនិត្យសុខភាពទៀងទាត់, ហាត់ប្រាណ)
• ឧបករណ៍សម្រាប់ការងារ (កុំព្យូទ័រ, ប្រដាប់ប្រដា)
• ការបង្កើនបណ្តាញទំនាក់ទំនងថ្មីៗ
• ការចាប់ផ្តើមអាជីវកម្មតូច

🎭 ក្រុមទី៣: ការកម្សាន្ត (LIFESTYLE)
ចំណាយសម្រាប់ការកម្សាន្ត និងការរីករាយផ្ទាល់ខ្លួន - មិនចាំបាច់ ប៉ុន្តែធ្វើឱ្យជីវិតមានសេចក្តីសុខ

🟡 ឧទាហរណ៍ចំណាយសម្រាប់ការកម្សាន្ត:
• ការកម្សាន្ត (ទីកន្លែងកម្សាន្ត, ភាពយន្ត)
• ការទិញទូរស័ព្ទម៉ូដែលថ្មីៗ
• សំលៀកបំពាក់ម៉ូដថ្មីៗ
• ការញ៉ាំអាហារនៅក្រៅផ្ទះញឹកញាប់ (នៅហាងថ្លៃៗ)
• ការធ្វើដំណើរកម្សាន្ត
• ការទិញរបស់របរផ្សេងៗដែលមិនចាំបាច់

🎯 សកម្មភាពរៀបចំតុល្យភាពភ្លាមៗ:

✅ បើចំណាយសម្រាប់ការរស់រាន (Survival) > 70%:
→ រកមធ្យោបាយកាត់បន្ថយចំណាយចាំបាច់ (ដូចជាជួលផ្ទះថោកជាង, ធ្វើម្ហូបនៅផ្ទះ)
→ បង្កើនចំណូល ដើម្បីមានថវិកាសម្រាប់ការលូតលាស់
→ ពិនិត្យមើលជម្រើសរបៀបរស់នៅ - តើវាចាំបាច់ពិតប្រាកដឬទេ?

✅ បើចំណាយសម្រាប់ការលូតលាស់ (Growth) < 15%:
→ កាត់បន្ថយចំណាយលើរបៀបរស់នៅ ៥០% ភ្លាមៗ
→ ចាប់ផ្តើមវគ្គសិក្សាអភិវឌ្ឍជំនាញ ១ មុខ
→ វិនិយោគ $20-50/ខែ លើការអភិវឌ្ឍខ្លួនឯង
→ រកឱកាសអាជីវកម្មដើម្បីបង្t ើនចំណូលបន្ថែម

✅ បើចំណាយសម្រាប់របៀបរស់នៅ (Lifestyle) > 30%:
→ កាត់បន្ថយការចំណាយលើការកម្សាន្ត ៤០%
→ ធ្វើម្ហូបនៅផ្ទះជំនួសការញ៉ាំនៅខាងក្រៅ
→ ពន្យារការទិញឧបករណ៍/សម្លៀកបំពាក់ថ្មី
→ បង្វែរ ១៥% នៃប្រាក់នោះទៅការវិនិយោគសម្រាប់ការលូតលាស់

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើចំណាយធំបំផុតរបស់ខ្ញុំស្ថិតក្នុងប្រភេទណាមួយរវាង ការរស់រាន, ការលូតលាស់, និងរបៀបរស់នៅ?"
២. "តើខ្ញុំចំណាយលើការលូតលាស់ប៉ុន្មានភាគរយ? តើវាគ្រប់គ្រាន់ហើយឬនៅ?"
៣. "តើអ្វីជាចំណាយសម្រាប់របៀបរស់នៅ (Lifestyle Expenses) ដែលខ្ញុំអាចកាត់បន្ថយបាន?"
៤. "តើតុល្យភាពដ៏ល្អសម្រាប់ខ្ញុំគួរតែ 60/25/15 ឬ 55/30/15?"

🎉 គន្លឹះជោគជ័យ:

• ចំណាយសម្រាប់ការរស់រានច្រើនពេក → ស្វែងរកជម្រើសដែលចំណាយធូរថ្លៃជាង (ដូចជាធ្វើម្ហូបនៅផ្ទះ, ជួលផ្ទះថោក)
• ចំណាយសម្រាប់ការលូតលាស់តិច → ចាប់ផ្តើមវគ្គសិក្សា/អភិវឌ្ឍជំនាញ ១ មុខភ្លាមៗ
• ចំណាយសម្រាប់ការកម្សាន្តច្រើនពេក → កាត់បន្ថយ ៥០% ហើយបង្វែរប្រាក់នោះទៅការលូតលាស់
• ត្រូវមានភាពប្រាកដនិយម - កែលម្អជាជំហានៗ, មិនមែនផ្លាស់ប្តូរអ្វីទាំងអស់ភ្លាមៗ

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ប្រើការវិភាគចំណាយនេះដើម្បីបង្កើតផែនការសកម្មភាពជាក់លាក់
- ចាប់ផ្តើមធ្វើការផ្លាស់ប្តូរ ១-២ យ៉ាងភ្លាមៗ
- តាមដានគំរូចំណាយថ្មីរបស់អ្នក

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: សម្រេចបានតុល្យភាពដ៏ល្អ 60/25/15 → ទទួលបាន "មគ្គុទេសក៍ការវិនិយោគសម្រាប់ការលូតលាស់នៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 5 COMPLETE - Balance: __/__/__%" + ចែករំលែកផែនការរៀបចំតុល្យភាពរបស់អ្នក!

ស្អែកយើងនឹងជ្រើសរើសចំណុចធំៗ ៣ យ៉ាងដើម្បីបញ្ឈប់ (Stop)/ចាប់ផ្តើម (Start)/បន្ត (Continue) សកម្មភាពច្បាស់លាស់!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day6`,

   6: `🔱 ថ្ងៃទី ៦: ម៉ាទ្រីសអាទិភាពសកម្មភាព - កំណត់ចំណុចសំខាន់ក្នុង 10 នាទី! 🔱

🔥 គោលដៅថ្ងៃនេះ: ទទួលបានផែនការសកម្មភាពផ្ទាល់ខ្លួន ៣ ចំណុច + ផែនការ ៣០ ថ្ងៃច្បាស់លាស់!

👋 ជំរាបសួរម្តងទៀត! ក្នុងរយៈពេល ៥ ថ្ងៃមុននេះ អ្នកបានបង្កើនប្រសិទ្ធភាពតុល្យភាពចំណាយរបស់អ្នករួចហើយ។ ថ្ងៃនេះយើងនឹងកំណត់ថាតើត្រូវបញ្ឈប់/ចាប់ផ្តើម/បន្តអ្វីខ្លះដើម្បីកាន់តែជោគជ័យ!

💎 ម៉ាទ្រីសអាទិភាពសកម្មភាពផ្ទាល់ខ្លួន (១០ នាទី)

⚡ ជំហានទី១ (៣ នាទី): ការវិភាគផលប៉ះពាល់ទម្លាប់លុយ
→ កត់ត្រាទម្លាប់លុយបច្ចុប្បន្នរបស់អ្នក
→ វាយតម្លៃផលប៉ះពាល់: ធំ vs តូច
→ វាយតម្លៃកម្រិតលំបាក: ងាយ vs ពិបាក

💡 ទម្លាប់ចំណាយលុយនៅកម្ពុជា (ទម្លាប់ទូទៅ):
ផលប៉ះពាល់ខ្ពស់ + ងាយស្រួល ចំណុចដើម្បីចាប់ផ្តើម (START):
• កត់ត្រាចំណាយធំៗជារៀងរាល់ថ្ងៃ (៥ នាទី/ថ្ងៃ)
• ធ្វើម្ហូបនៅផ្ទះជំនួសការបញ្ជាទិញ (delivery) ៣ ដង/សប្តាហ៍
• កំណត់ការសន្សំដោយស្វ័យប្រវត្តិ (Auto-save) $20/ខែ នៅ ABA/ACLEDA

ផលប៉ះពាល់ខ្ពស់ + ងាយស្រួល ចំណុចដើម្បីបញ្ឈប់ (STOP):
• បោះបង់ការជាវ (subscriptions) ដែលមិនប្រើ (Netflix, Spotify)
• បញ្ឈប់ការទិញភ្លាមៗតាម Facebook ads
• កាត់បន្ថយចំណាយលើ KTV/bar ៥០%

⚡ ជំហានទី២ (៤ នាទី): ការវាយតម្លៃអាទិភាពផ្ទាល់ខ្លួន
→ ពីការវិភាគថ្ងៃមុនៗ តើអ្នកត្រូវការកែលម្អអ្វីបំផុត?
→ ជ្រើសរើស ១ ចំណុចដើម្បីបញ្ឈប់ (STOP), ១ ចំណុចដើម្បីចាប់ផ្តើម (START), ១ ចំណុចដើម្បីបន្ត (CONTINUE)
→ កំណត់កាលកំណត់ច្បាស់លាស់ (timeline)

⚡ ជំហានទី៣ (៣ នាទី): ម៉ាស៊ីនគណនាផលប៉ះពាល់សកម្មភាព
→ គណនាលទ្ធផលដែលរំពឹងទុក
→ កំណត់របៀបតាមដានវឌ្ឍនភាព
→ បង្កើតផែនការទទួលខុសត្រូវ (accountability plan)

📊 ម៉ាស៊ីនគណនាអាទិភាពសកម្មភាព:

ចំណុចដើម្បីបញ្ឈប់ (STOP) (ជ្រើសរើស ១):
□ ចំណាយតាមអារម្មណ៍/ស្ត្រេស: សន្សំបាន $____/ខែ
□ បោះបង់ការជាវដែលមិនប្រើ: សន្សំបាន $____/ខែ
□ កាត់បន្ថយចំណាយលើរបៀបរស់នៅ ៣០%: សន្សំបាន $____/ខែ
□ បញ្ឈប់ការទិញទំនិញអនឡាញពេលយប់ជ្រៅ: សន្សំបាន $____/ខែ
→ ខ្ញុំនឹងបញ្ឈប់ (STOP): ________________

ចំណុចដើម្បីចាប់ផ្តើម (START) (ជ្រើសរើស ១):
□ កត់ត្រាចំណាយប្រចាំថ្ងៃ: បង្កើនការយល់ដឹង ៨០%
□ កំណត់ការសន្សំដោយស្វ័យប្រវត្តិ (Auto-save) $____/ខែ: បង្កើតមូលនិធិបន្ទាន់
□ ចាប់ផ្តើមរកចំណូលបន្ថែម $____/ខែ
□ រៀនជំនាញថ្មី ១: បង្កើនសក្តានុពលចំណូល
→ ខ្ញុំនឹងចាប់ផ្តើម (START): ________________

ចំណុចដើម្បីបន្ត (CONTINUE) (ជ្រើសរើស ១):
□ បន្តគ្រប់គ្រងលុយតាមប្រព័ន្ធ ៧ ថ្ងៃ
□ បន្តបង្កើនប្រសិទ្ធភាពតុល្យភាពចំណាយ
□ បន្តរកចំណូលបន្ថែម
□ បន្តសិក្សាអំពីហិរញ្ញវត្ថុផ្ទាល់ខ្លួន
→ ខ្ញុំនឹងបន្ត (CONTINUE): ________________

🏆 ការធានា: មិនអាចសម្រេចបាន ៧០% នៃផែនការសកម្មភាពក្នុង ៣០ ថ្ងៃ? ទាក់ទង @Chendasum (Telegram/WhatsApp) នឹងទទួលបានការប្រឹក្សាឥតគិតថ្លៃ!

📈 របាយការណ៍ជោគជ័យនៃការរៀបចំផែនការសកម្មភាព (អ្នកប្រើប្រាស់នៅកម្ពុជា):

👤 អ្នកស្រី វណ្ណី (២៨ ឆ្នាំ, គិលានុបដ្ឋាយិកា, ភ្នំពេញ):
"ខ្ញុំបានកាត់បន្ថយចំណាយលើការកម្សាន្ត + ចាប់ផ្តើមរៀបចំអាហារ (meal prep) = សន្សំបាន $135/ខែ តាមការគណនាឡើងវិញ!"

👤 លោក ធារ៉ា (៣៥ ឆ្នាំ, អ្នកបើកបរ, កំពត):
"ខ្ញុំបានកាត់បន្ថយចំណាយមិនល្អ + បើក Grab ពេលល្ងាច = អាចបង្កើនចំណូលប្រមាណ $280/ខែ!"

👤 អ្នកស្រី ចន្ទនី (២៦ ឆ្នាំ, ម្ចាស់ហាង, បាត់ដំបង):
"ខ្ញុំបានត្រួតពិនិត្យការចំណាយតាមអារម្មណ៍ + រៀនបន្ថែម = ប្រាក់ចំណេញកើនឡើងច្រើន!"

---

🎯 ការយល់ដឹងសំខាន់:
ការផ្លាស់ប្តូរមិនត្រូវការច្រើន ឬស្មុគស្មាញទេ។ គ្រាន់តែ ៣ ចំណុចធំៗប៉ុណ្ណោះ។

🚫 ចំណុចទី១: ឈប់ធ្វើ
អ្វីដែលអ្នកគួរឈប់ធ្វើ

🔴 ឧទាហរណ៍ចំណុចដែលគួរឈប់ធ្វើ:
• ឈប់ចំណាយលុយដោយមិនគិត
• ឈប់ទិញអ្វីដែលមិនចាំបាច់
• ឈប់ញ៉ាំនៅខាងក្រៅញឹកញាប់ពេក
• ឈប់ប្រើប្រាស់ការជាវ (subscriptions) ដែលមិនបានប្រើ
• ឈប់ទិញនៅពេលមានអារម្មណ៍មិនល្អ

✅ ចំណុចទី២: ចាប់ផ្តើមធ្វើ
អ្វីដែលអ្នកគួរចាប់ផ្តើមធ្វើ

🟢 ឧទាហរណ៍ចំណុចដែលគួរចាប់ផ្តើម:
• ចាប់ផ្តើមកត់ត្រាចំណាយ
• ចាប់ផ្តើមសន្សំបន្តិចបន្តួច
• ចាប់ផ្តើមគិតមុនពេលទិញ
• ចាប់ផ្តើមរៀនអំពីការគ្រប់គ្រងលុយ
• ចាប់ផ្តើមរៀបចំគោលដៅ

🔄 ចំណុចទី៣: បន្តធ្វើ
អ្វីដែលអ្នកកំពុងធ្វើបានល្អរួចហើយ ហើយគួរតែបន្ត

🟡 ឧទាហរណ៍ចំណុចដែលគួរបន្ត:
• បន្តចំណាយដោយស្មារតី (Conscious spending)
• បន្តសន្សំប្រាក់ឱ្យបានទៀងទាត់
• បន្តគិតមុនពេលទិញរបស់ធំៗ
• បន្តរកមាគ៌ាបង្កើនចំណូល
• បន្តសិក្សារៀនសូត្រនូវអ្វីដែលថ្មី

🎯 ផែនទីផ្លូវអនុវត្តរយៈពេល ៣០ ថ្ងៃ:

សប្តាហ៍ទី ១ (ថ្ងៃ ១-៧):
→ ចាប់ផ្តើមសកម្មភាពបញ្ឈប់ភ្លាមៗ
→ រៀបចំប្រព័ន្ធសម្រាប់សកម្មភាពចាប់ផ្តើម
→ តាមដានវឌ្ឍនភាពជារៀងរាល់ថ្ងៃ
→ អនុវត្តសកម្មភាពបន្ត

សប្តាហ៍ទី ២ (ថ្ងៃ ៨-១៤):
→ បន្តសកម្មភាពបញ្ឈប់ + មើលលទ្ធផល
→ ចាប់ផ្តើមសកម្មភាពចាប់ផ្តើមពេញលេញ
→ បង្កើនប្រសិទ្ធភាពសកម្មភាពបន្ត
→ វាយតម្លៃបញ្ហាប្រឈមនានា

សប្តាហ៍ទី ៣ (ថ្ងៃ ១៥-២១):
→ បង្កើតទម្លាប់ដោយស្វ័យប្រវត្តិ (habit formation)
→ កែលម្អសកម្មភាពតាមបទពិសោធន៍
→ វាស់វែងលទ្ធផលដែលបានទទួល
→ កែសម្រួលកាលកំណត់ប្រសិនបើត្រូវការ

សប្តាហ៍ទី ៤ (ថ្ងៃ ២២-៣០):
→ ពង្រឹងទម្លាប់ថ្មីៗ
→ រៀបចំផែនការបន្តទៅមុខ
→ កំណត់គោលដៅបន្ទាប់
→ អបអរសមិទ្ធផលដែលទទួលបាន!

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើសកម្មភាពទាំង ៣ ដែលខ្ញុំជ្រើសរើសមានផលប៉ះពាល់ធំបំផុតលើស្ថានភាពហិរញ្ញវត្ថុរបស់ខ្ញុំដែរឬទេ?"
២. "តើចំណុចណាដែលខ្ញុំអាចធ្វើបានភ្លាមៗ ធៀបនឹងចំណុចដែលត្រូវការពេលបន្ថែម?"
៣. "តើខ្ញុំនឹងដឹងថាខ្ញុំជោគជ័យដោយរបៀបណា?"

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីចំណុចតូចៗ - ផ្តោតលើសកម្មភាពតែ ៣ ប៉ុណ្ណោះ
• ជ្រើសរើសអ្វីដែលងាយស្រួល - បង្កើតកម្លាំងជំរុញមុន
• ធ្វើការជាក់ស្តែង - កំណត់សកម្មភាពជាក់លាក់ មិនមែនគោលដៅមិនច្បាស់លាស់
• តាមដានវឌ្ឍនភាព - ពិនិត្យប្រចាំសប្តាហ៍, កែសម្រួលប្រចាំខែ
• មានការទទួលខុសត្រូវ - ប្រាប់អ្នកដទៃអំពីគោលដៅរបស់អ្នក

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមអនុវត្តសកម្មភាពទាំង ៣ ភ្លាមៗ
- រៀបចំប្រព័ន្ធតាមដាន
- ត្រៀមខ្លួនសម្រាប់ការបញ្ចប់កម្មវិធី + គន្លឹះសម្រាប់កម្រិតបន្ទាប់

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🤖 Claude AI Assistant:

💬 /ask [សំណួរ] - សួរអ្វីក៏បាន អំពីលុយ
🎯 /coach - ការណែនាំផ្ទាល់ខ្លួន
🔍 /find_leaks - រកមើល Money Leaks
🆘 /ai_help - ជំនួយពេញលេញ

ឧទាហរណ៍: /ask តើខ្ញុំគួរសន្សំយ៉ាងណា?

🎁 BONUS ដោះសោ: សម្រេចបាន ៧០%+ នៃផែនការសកម្មភាព → ទទួលបាន "ឧបករណ៍តាមដានការគ្រប់គ្រងលុយរយៈពេល ៣០ ថ្ងៃនៅកម្ពុជា" ពិសេស!

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 6 COMPLETE - Actions: STOP __, START __, CONTINUE __" + ចែករំលែកផែនការ ៣០ ថ្ងៃរបស់អ្នក!

ថ្ងៃស្អែកកម្មវិធីនឹងបញ្ចប់! យើងនឹងរៀបចំផែនការបន្តទៅមុខ + បង្ហាញឱកាសសម្រាប់កម្រិតបន្ទាប់!

🌐 ធនធានបន្ថែម: 7daymoneyflow.com

បញ្ចប់? ចុច /day7`,

   7: `🔱 ថ្ងៃទី ៧: ថ្ងៃបញ្ចប់ការសិក្សា - វាស់ជោគជ័យ និងជំហានបន្ទាប់! 🔱

🎉 អបអរសាទរ! អ្នកបានបញ្ចប់កម្មវិធី 7-Day Money Flow Reset™ រួចហើយ!

💎 ម៉ាស៊ីនគណនាសមិទ្ធផលរយៈពេល ៧ ថ្ងៃ - វាស់ជោគជ័យភ្លាមៗ! (៥ នាទី)

⚡ កត់ត្រាសមិទ្ធផលរបស់អ្នក:
→ ថ្ងៃទី ១: រកបាន $____/ខែ តាមរយៈសកម្មភាពភ្លាមៗ
→ ថ្ងៃទី ២: បិទចំណុចលេចធ្លាយលុយ $____/ខែ
→ ថ្ងៃទី ៣: ពិន្ទុសុខភាពហិរញ្ញវត្ថុ: ___% → ___%
→ ថ្ងៃទី ៤: លំហូរលុយ: $____ (+ វិជ្ជមាន / - អវិជ្ជមាន)
→ ថ្ងៃទី ៥: តុល្យភាពចំណាយ: __/__/__ %
→ ថ្ងៃទី ៦: សកម្មភាពអាទិភាព ៣ យ៉ាងត្រូវបានកំណត់រួចរាល់

📊 ពិន្ទុនៃការផ្លាស់ប្តូរសរុប:
ប្រាក់ដែលរកបាន/សន្សំបាន: $____/ខែ = $____/ឆ្នាំ
ការកែលម្អពិន្ទុសុខភាព: ___% → ___%
ស្ថានភាពលំហូរលុយ: អវិជ្ជមាន → វិជ្ជមាន / កើនឡើង $____
តុល្យភាពចំណាយ: មានប្រសិទ្ធភាព ___%

🏆 កម្រិតបញ្ចប់ការសិក្សារបស់អ្នក:
• សន្សំបាន $50+/ខែ = Bronze Graduate 🥉
• សន្សំបាន $100+/ខែ = Silver Graduate 🥈
• សន្សំបាន $200+/ខែ = Gold Graduate 🥇
• សន្សំបាន $300+/ខែ = Platinum Graduate 💎

📈 បញ្ជីឈ្មោះអ្នកជោគជ័យនៅកម្ពុជា:

🥇 អ្នកស្រី សុខមុន្នី (២៤ ឆ្នាំ, គណនេយ្យករ, ភ្នំពេញ) - GOLD GRADUATE:
"៧ ថ្ងៃរកបាន $215/ខែ! ខ្ញុំបានបោះបង់ការជាវ $35 + បិទការលេចធ្លាយ $85 + បង្កើនប្រសិទ្ធភាពចំណាយ $95 = ឥឡូវមានមូលនិធិបន្ទាន់ $2,000!"

🥈 លោក វុទ្ធី (៣១ ឆ្នាំ, អ្នកបើកបរ Tuk-tuk, សៀមរាប) - SILVER GRADUATE:
"ពីអវិជ្ជមាន -$45 ទៅវិជ្ជមាន +$130/ខែ! ខ្ញុំបានហាត់បើក Grab ពេលល្ងាច + កាត់បន្ថយការចំណាយលើស្រាបៀរ/បារី = ឥឡូវសន្សំបានសម្រាប់ម៉ូតូថ្មី!"

💎 អ្នកស្រី ចាន់ធីតា (២៧ ឆ្នាំ, អ្នកលក់អនឡាញ, បាត់ដំបង) - PLATINUM GRADUATE:
"ការវិភាគលំហូរលុយបានបង្ហាញពីចំណុចលេចធ្លាយនៅក្នុងអាជីវកម្ម! ខ្ញុំបានកែសម្រួលស្តុកទំនិញ + តម្លៃ = ប្រាក់ចំណេញកើនឡើង $320/ខែ + ចាប់ផ្តើមអាជីវកម្មទី ២!"

🎊 ពេលវេលាអបអរសាទរផ្ទាល់ខ្លួនរបស់អ្នក:

✅ ចំណុចទី១: អបអរសមិទ្ធផលរបស់អ្នក!
តើអ្នកទទួលបានអ្វីខ្លះ?
□ ការយល់ដឹងផ្នែកហិរញ្ញវត្ថុកើនឡើង 200%+
□ រកឃើញចំណុចលេចធ្លាយលុយដែលមិនបានដឹង
□ មានផែនការសកម្មភាពច្បាស់លាស់រយៈពេល ៣០ ថ្ងៃ
□ ដឹងពីតុល្យភាពចំណាយដ៏ល្អ
□ មានទំនុកចិត្តក្នុងការគ្រប់គ្រងលុយ

អ្នកមិនត្រឹមតែរៀនប៉ុណ្ណោះទេ... អ្នកបានផ្លាស់ប្តូរ!

🔧 ចំណុចទី២: បង្កើតទម្លាប់យូរអង្វែង
ទម្លាប់ដែលនឹងផ្លាស់ប្តូរជីវិតអ្នក:

🟡 ទម្លាប់ប្រចាំថ្ងៃ (៥ នាទី/ថ្ងៃ):
• ពិនិត្យសមតុល្យគណនីធនាគារមុនពេលចំណាយធំ
• សួរខ្លួនឯងថា "ចាំបាច់ទេ? ឬ ចង់បាន?" មុនពេលទិញ
• កត់ត្រាចំណាយដែលមានតម្លៃលើសពី $20

🟢 ទម្លាប់ប្រចាំសប្តាហ៍ (១៥ នាទី/សប្តាហ៍):
• ត្រួតពិនិត្យចំណាយប្រចាំសប្តាហ៍ធៀបនឹងថវិកា
• ពិនិត្យវឌ្ឍនភាពលើគោលដៅហិរញ្ញវត្ថុ
• រៀបចំផែនការទិញធំៗសម្រាប់សប្តាហ៍បន្ទាប់

🔵 ទម្លាប់ប្រចាំខែ (៣០ នាទី/ខែ):
• វិភាគលំហូរលុយពេញលេញ
• បង្កើនប្រសិទ្ធភាពប្រភេទចំណាយ
• កំណត់/កែសម្រួលគោលដៅហិរញ្ញវត្ថុ
• អបអរសមិទ្ធផលដែលទទួលបាន!

🌱 ចំណុចទី៣: បន្តការលូតលាស់
ដំណើរនេះទើបតែចាប់ផ្តើម...

🚀 ផែនការសកម្មភាពរយៈពេល ៣០ ថ្ងៃបន្ទាប់:

សប្តាហ៍ទី ១-២: ពង្រឹងមូលដ្ឋាន
→ អនុវត្តសកម្មភាពអាទិភាព ៣ យ៉ាងពីថ្ងៃទី ៦
→ បង្កើតប្រព័ន្ធស្វ័យប្រវត្តិ (ការសន្សំស្វ័យប្រវត្តិ, ការតាមដាន)
→ វាស់វែង និងកែសម្រួលតាមលទ្ធផល

សប្តាហ៍ទី ៣-៤: ការបង្កើនប្រសិទ្ធភាព និងការពង្រីក
→ កែសម្រួលតុល្យភាពចំណាយឱ្យកាន់តែល្អិតល្អន់
→ ស្វែងរកឱកាសបង្កើនចំណូល
→ ចាប់ផ្តើមយុទ្ធសាស្ត្រកម្រិតខ្ពស់

🏛️ មានអ្វីមួយកាន់តែពិសេសកំពុងរង់ចាំ...

🤫 អ្វីដែលអ្នកទើបរៀននេះ គ្រាន់តែជា "ការគ្រប់គ្រងលុយ" ប៉ុណ្ណោះ។

តែ Cambodia MONEY MASTERS ពិតប្រាកដបានឈានទៅដល់កម្រិតបន្ទាប់ហើយ...

💰 អាថ៌កំបាំងនៃការកសាងទ្រព្យសម្បត្តិ:
• តើអ្នកអាចធ្វើឱ្យលុយធ្វើការឱ្យអ្នកដោយរបៀបណា?
• របៀបបង្កើតប្រភពចំណូលអកម្ម (PASSIVE INCOME streams) នៅកម្ពុជា?
• ការចូលរួមបណ្តាញ EXCLUSIVE នៃអ្នករកចំណូលខ្ពស់បំផុត 5%?

🔥 វិធីសាស្រ្តបង្កើនល្បឿនអាជីវកម្ម:
• ឱកាសវិនិយោគជាក់លាក់នៅកម្ពុជា
• ពង្រីកអាជីវកម្មពី $500 → $5,000/ខែ
• យុទ្ធសាស្ត្រពន្ធកម្រិតខ្ពស់ និងការការពារទ្រព្យសម្បត្តិ

💎 ការចូលប្រើយុទ្ធសាស្ត្រមូលធន VIP:
• វគ្គបង្វឹកហិរញ្ញវត្ថុផ្ទាល់ខ្លួន (1-on-1 sessions)
• ក្រុមវិនិយោគផ្តាច់មុខនៅកម្ពុជា
• បច្ចេកទេសបង្កើនប្រាក់កម្រិតខ្ពស់

🎯 ប៉ុន្តែ... មិនមែនគ្រប់គ្នាទេដែលបានត្រៀមខ្លួនរួចរាល់។

កម្រិត VIP ត្រូវការ:
✅ បានបញ្ចប់ 7-Day Reset ដោយជោគជ័យ
✅ សម្រេចបានការកែលម្អ $100+ ប្រចាំខែ
✅ បង្ហាញការប្តេជ្ញាចិត្តចំពោះការលូតលាស់ផ្នែកហិរញ្ញវត្ថុ
✅ ត្រៀមខ្លួនសម្រាប់កម្រិតវិនិយោគបន្ទាប់

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើខ្ញុំត្រៀមខ្លួនរួចរាល់សម្រាប់កម្រិតបន្ទាប់ហើយឬនៅ?"
២. "តើទម្លាប់មួយណាដែលខ្ញុំចង់បង្កើតមុនគេ?"
៣. "តើខ្ញុំចង់ក្លាយជាអ្នកគ្រប់គ្រងលុយ ឬ អ្នកកសាងទ្រព្យសម្បត្តិ?"

🎉 គន្លឹះជោគជ័យចុងក្រោយ:

• ចាប់ផ្តើមពីចំណុចតូច - វឌ្ឍនភាពប្រសើរជាងភាពល្អឥតខ្ចោះ
• ធ្វើជាទម្លាប់ - ភាពទៀងទាត់ប្រសើរជាងអាំងតង់ស៊ីតេ
• ចែករំលែកជាមួយអ្នកដទៃ - ការបង្រៀនធ្វើឱ្យការរៀនកាន់តែខ្លាំង
• មិនឈប់រៀន - ទេសភាពហិរញ្ញវត្ថុផ្លាស់ប្តូរជានិច្ច

💡 ការរំលឹកចុងក្រោយ:
- កម្មវិធីបានបញ្ចប់ហើយ ប៉ុន្តែដំណើររបស់អ្នកទើបតែចាប់ផ្តើម
- អ្នកឥឡូវមានឧបករណ៍ និងចំណេះដឹងដើម្បីជោគជ័យ
- ការអនុវត្តជាប្រចាំ គឺជាគន្លឹះនៃការផ្លាស់ប្តូរពិតប្រាកដ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum (Telegram/WhatsApp)
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🎁 BONUS ចុងក្រោយ: បញ្ចប់ការសិក្សាដោយមានការកែលម្អ $100+ → ទទួលបាន "វិញ្ញាបនបត្រមេហិរញ្ញវត្ថុនៅកម្ពុជា" (Cambodia Money Master Certificate) + ការអញ្ជើញចូលរួមវគ្គយុទ្ធសាស្ត្រ VIP!

🎊 ពិធីបញ្ចប់ការសិក្សា:

🏆 អ្នកបានបញ្ចប់ 7-Day Money Flow Reset™!
🎓 អ្នកឥឡូវជា Cambodia Money Flow Graduate!
🚀 ដំណើរទៅកាន់សេរីភាពហិរញ្ញវត្ថុរបស់អ្នកបានចាប់ផ្តើមហើយ!

✅ កិច្ចការបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "GRADUATE COMPLETE - Saved $____/month, Ready for [Bronze/Silver/Gold/Platinum] level!" + ចែករំលែកអារម្មណ៍របស់អ្នក!

🤐 យុទ្ធសាស្ត្រមូលធន VIP នឹងបើកទ្វារសម្រាប់អ្នកដែលបញ្ចប់ការសិក្សាដ៏ឆ្នើម...

🌐 ធនធានកម្មវិធី: 7daymoneyflow.com
🔗 ព័ត៌មានកម្រិតបន្ទាប់: @Chendasum (ការអញ្ជើញ VIP តែប៉ុណ្ណោះ)

---

បញ្ចប់? ចុច /day7`,
};

/**
 * Enhanced handle function with beautiful UI and improved error handling
 */
async function handle(msg, match, bot) {
   const dayNumber = parseInt(match[1]);
   const userId = msg.from.id;
   const chatId = msg.chat.id;
   
   console.log("=== ENHANCED DAILY HANDLER ===", { 
       user_id: userId,
       dayNumber: dayNumber,
       timestamp: new Date().toISOString()
   });

   try {
      // Validate day number
      if (dayNumber < 1 || dayNumber > CONFIG.TOTAL_DAYS) {
         await bot.sendMessage(chatId, "ថ្ងៃមិនត្រឹមត្រូវ។ សូមជ្រើសរើសពី ១ ដល់ ៧។");
         return;
      }

      // Find user and progress with enhanced error handling
      const [user, progress] = await Promise.all([
         User.findOne({ telegram_id: userId }),
         Progress.findOne({ user_id: userId })
      ]);

      if (!user) {
         await bot.sendMessage(chatId, "សូមចុច /start ដើម្បីចាប់ផ្តើមកម្មវិធី។");
         return;
      }

      // Enhanced payment status check
      const isPaid = user.is_paid === true || user.is_paid === 't' || user.is_paid === 1;
      
      console.log("=== PAYMENT CHECK ===", {
         user_id: userId,
         is_paid_raw: user.is_paid,
         is_paid_converted: isPaid,
         tier: user.tier
      });
      
      if (!isPaid) {
         await bot.sendMessage(chatId, "🔒 សូមទូទាត់មុនដើម្បីចូលរួមកម្មវិធី។ ប្រើ /pricing ដើម្បីមើលព័ត៌មាន។");
         return;
      }

      if (!progress) {
         await bot.sendMessage(chatId, "សូមចុច /start ដើម្បីចាប់ផ្តើមកម្មវិធី។");
         return;
      }

      // Auto-fix for Day 1 access with enhanced logging
      if (dayNumber === 1 && !progress.ready_for_day_1) {
         console.log(`🚨 Auto-fixing Day 1 access for user ${userId}`);
         await Progress.findOneAndUpdate(
            { user_id: userId },
            { ready_for_day_1: true, currentDay: 1 },
            { upsert: true }
         );
      }

      // Enhanced completed days calculation
      const completedDays = [];
      for (let i = 1; i <= 7; i++) {
         if (progress[`day${i}Completed`]) {
            completedDays.push(i);
         }
      }
      
      const maxAccessibleDay = Math.max(dayNumber, progress.currentDay || 1);
      
      // Enhanced day accessibility check
      if (dayNumber > 1 && dayNumber > (progress.currentDay || 1)) {
         await bot.sendMessage(chatId, `🔒 សូមបញ្ចប់ថ្ងៃទី ${(progress.currentDay || 1)} មុនដើម្បីចាប់ផ្តើមថ្ងៃទី ${dayNumber}។`);
         return;
      }

      // Generate enhanced lesson overview with achievements
      const userProgressData = {
         completedDays,
         currentDay: progress.currentDay || 1,
         totalMoneySaved: progress.totalMoneySaved || 0,
         [`day${dayNumber}CompletedAt`]: progress[`day${dayNumber}CompletedAt`],
         timestamp: new Date().toLocaleTimeString('km-KH', { 
            hour: '2-digit', 
            minute: '2-digit',
            timeZone: 'Asia/Phnom_Penh'
         })
      };
      
      const overviewMessage = createDayOverview(dayNumber, userProgressData);
      
      // Generate enhanced interactive navigation
      const keyboard = createNavigationKeyboard(dayNumber, completedDays, maxAccessibleDay);
      
      // Send enhanced lesson overview with beautiful formatting
      await bot.sendMessage(chatId, overviewMessage, {
         parse_mode: 'Markdown',
         reply_markup: keyboard,
         disable_web_page_preview: true
      });

      // Enhanced progress tracking with analytics
      await Promise.all([
         Progress.findOneAndUpdate(
            { user_id: userId },
            {
               currentDay: Math.max(dayNumber, progress.currentDay || 0),
               [`day${dayNumber}AccessedAt`]: new Date(),
               lastActiveDay: dayNumber,
               updatedAt: new Date(),
               $inc: { [`day${dayNumber}Views`]: 1 }
            },
            { upsert: true }
         ),
         User.findOneAndUpdate(
            { telegram_id: userId },
            { last_active: new Date() }
         )
      ]);

   } catch (error) {
      console.error("Error in enhanced daily command:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'handle');
   }
}

/**
 * Enhanced callback handler with comprehensive action support
 */
async function handleCallback(query, bot) {
   const { data, message, from } = query;
   const userId = from.id;
   const chatId = message.chat.id;

   try {
      console.log("=== ENHANCED CALLBACK DEBUG ===", { data, userId });
      
      const [action, param, param2] = data.split('_');
      
      switch (action) {
         case 'day':
            const dayNum = parseInt(param);
            
            // Enhanced same-day check
            const currentText = message.text || '';
            if (currentText.includes(`ថ្ងៃទី ${dayNum}:`)) {
               await bot.answerCallbackQuery(query.id, { 
                  text: `អ្នកកំពុងនៅថ្ងៃទី ${dayNum} ហើយ`, 
                  show_alert: false 
               });
               return;
            }
            
            // Navigate to different day with enhanced handling
            await handleDayNavigation(bot, chatId, message.message_id, userId, dayNum);
            await bot.answerCallbackQuery(query.id, { 
               text: `ថ្ងៃទី ${dayNum}`, 
               show_alert: false 
            });
            break;
            
         case 'start':
            // Enhanced lesson start handling
            let lessonDay;
            if (param === 'lesson') {
               lessonDay = parseInt(param2); // start_lesson_1
            } else {
               lessonDay = parseInt(param); // start_1
            }
            
            console.log("=== STARTING ENHANCED LESSON ===", { lessonDay });
            
            if (lessonDay && lessonDay >= 1 && lessonDay <= 7) {
               await startLesson(bot, chatId, userId, lessonDay);
               await bot.answerCallbackQuery(query.id, { 
                  text: `កំពុងចាប់ផ្តើមមេរៀនថ្ងៃទី ${lessonDay}...`, 
                  show_alert: false 
               });
            } else {
               await bot.answerCallbackQuery(query.id, { 
                  text: "មេរៀនមិនមាន", 
                  show_alert: true 
               });
            }
            break;
            
         case 'complete':
            const completeDay = parseInt(param);
            const success = await markDayComplete(userId, completeDay);
            if (success) {
               // Enhanced completion with achievements
               const progress = await Progress.findOne({ user_id: userId });
               const achievements = gamificationSystem.calculateAchievements({
                  completedDays: [completeDay],
                  totalMoneySaved: progress?.totalMoneySaved || 0
               });
               
               let completionMsg = `🎉 បានបញ្ចប់ថ្ងៃទី ${completeDay}!`;
               if (achievements.length > 0) {
                  completionMsg += `\n🏆 ${achievements[0]}`;
               }
               
               await bot.answerCallbackQuery(query.id, { 
                  text: completionMsg,
                  show_alert: true 
               });
               
               // Send enhanced completion message
               let nextMsg = `✅ **ថ្ងៃទី ${completeDay} បានបញ្ចប់!**\n\n`;
               if (achievements.length > 0) {
                  nextMsg += `🎖️ **ជោគជ័យថ្មី:** ${achievements.join(', ')}\n\n`;
               }
               nextMsg += `🚀 **បន្ទាប់:** /day${completeDay + 1 <= 7 ? completeDay + 1 : 7}`;
               
               await bot.sendMessage(chatId, nextMsg, { parse_mode: 'Markdown' });
            } else {
               await bot.answerCallbackQuery(query.id, { 
                  text: "មានបញ្ហាកត់ត្រា", 
                  show_alert: true 
               });
            }
            break;
            
         case 'overview':
            await showProgramOverview(bot, chatId, message.message_id, userId);
            await bot.answerCallbackQuery(query.id, { 
               text: "ទិដ្ឋភាពទូទៅ", 
               show_alert: false 
            });
            break;
            
         case 'achievements':
            await showUserAchievements(bot, chatId, userId);
            await bot.answerCallbackQuery(query.id, { 
               text: "ជោគជ័យរបស់អ្នក", 
               show_alert: false 
            });
            break;

         case 'tip':
            const tipDay = parseInt(param);
            await sendPersonalizedTip(bot, chatId, userId, tipDay);
            await bot.answerCallbackQuery(query.id, { 
               text: "គន្លឹះពិសេស", 
               show_alert: false 
            });
            break;
            
         case 'locked':
            await bot.answerCallbackQuery(query.id, {
               text: "សូមបញ្ចប់ថ្ងៃមុនដើម្បីចូលប្រើ",
               show_alert: true
            });
            break;
            
         default:
            console.log("=== UNKNOWN CALLBACK ===", { action, param, param2 });
            await bot.answerCallbackQuery(query.id, { 
               text: "មុខងារកំពុងអភិវឌ្ឍ", 
               show_alert: false 
            });
      }
      
   } catch (error) {
      console.error("Error handling enhanced callback:", error);
      await bot.answerCallbackQuery(query.id, {
         text: "មានបញ្ហាបច្ចេកទេស",
         show_alert: true
      });
   }
}

/**
 * Enhanced day navigation with smooth transitions
 */
async function handleDayNavigation(bot, chatId, messageId, userId, dayNumber) {
   try {
      const progress = await Progress.findOne({ user_id: userId });
      if (!progress) return;
      
      const completedDays = [];
      for (let i = 1; i <= 7; i++) {
         if (progress[`day${i}Completed`]) {
            completedDays.push(i);
         }
      }
      
      const maxAccessibleDay = progress.currentDay || 1;
      
      // Enhanced progress data with achievements
      const userProgressData = {
         completedDays,
         currentDay: progress.currentDay || 1,
         totalMoneySaved: progress.totalMoneySaved || 0,
         [`day${dayNumber}CompletedAt`]: progress[`day${dayNumber}CompletedAt`],
         timestamp: new Date().toLocaleTimeString('km-KH', { 
            hour: '2-digit', 
            minute: '2-digit',
            timeZone: 'Asia/Phnom_Penh'
         })
      };
      
      const overviewMessage = createDayOverview(dayNumber, userProgressData);
      const keyboard = createNavigationKeyboard(dayNumber, completedDays, maxAccessibleDay);
      
      try {
         await bot.editMessageText(overviewMessage, {
            chat_id: chatId,
            message_id: messageId,
            parse_mode: 'Markdown',
            reply_markup: keyboard,
            disable_web_page_preview: true
         });
      } catch (error) {
         // Fallback: send new message if edit fails
         console.log("Edit failed, sending new message:", error.message);
         await bot.sendMessage(chatId, overviewMessage, {
            parse_mode: 'Markdown',
            reply_markup: keyboard,
            disable_web_page_preview: true
         });
      }
   } catch (error) {
      console.error("Error in handleDayNavigation:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'handleDayNavigation');
   }
}

/**
 * Enhanced lesson delivery with smart chunking and error recovery
 */
async function startLesson(bot, chatId, userId, dayNumber) {
   console.log("=== ENHANCED START LESSON ===", { userId, dayNumber });
   
   try {
      if (!dailyMessages[dayNumber]) {
         await bot.sendMessage(chatId, `❌ **មេរៀនថ្ងៃទី ${dayNumber} មិនទាន់មាន**\n\n📞 **ទាក់ទង:** @Chendasum សម្រាប់មេរៀន`, { parse_mode: 'Markdown' });
         return;
      }

      // Send enhanced starting message
      await bot.sendMessage(chatId, `🚀 **ចាប់ផ្តើមមេរៀនថ្ងៃទី ${dayNumber}**\n\nកំពុងត្រៀមខ្លឹមសារ...`, { 
         parse_mode: 'Markdown' 
      });
      
      // Get and optimize content using enhanced chunking
      const content = dailyMessages[dayNumber];
      const chunks = contentOptimization.optimizeContentDelivery(content, CONFIG.MESSAGE_CHUNK_SIZE);
      
      console.log(`=== SENDING ${chunks.length} ENHANCED CHUNKS ===`);
      
      // Send each chunk with improved error handling
      for (let i = 0; i < chunks.length; i++) {
         try {
            await bot.sendMessage(chatId, chunks[i], { 
               parse_mode: 'Markdown',
               disable_web_page_preview: true 
            });
            
            // Smart delay between chunks
            if (i < chunks.length - 1) {
               await new Promise(resolve => setTimeout(resolve, CONFIG.DEFAULT_DELAY));
            }
         } catch (chunkError) {
            console.error(`Error sending chunk ${i + 1}:`, chunkError.message);
            
            // Enhanced fallback strategy
            try {
               // Try without markdown
               await bot.sendMessage(chatId, chunks[i]);
            } catch (plainError) {
               // Last resort: error message
               await bot.sendMessage(chatId, `❌ មានបញ្ហាផ្នែកទី ${i + 1} - ទាក់ទង @Chendasum`);
            }
         }
      }
      
      // Enhanced progress tracking
      await Progress.findOneAndUpdate(
         { user_id: userId },
         {
            [`day${dayNumber}AccessedAt`]: new Date(),
            lastActive: new Date(),
            $inc: { [`day${dayNumber}Views`]: 1 }
         }
      );
      
      // Send enhanced completion message with achievements
      const progress = await Progress.findOne({ user_id: userId });
      const completedDays = [];
      for (let i = 1; i <= 7; i++) {
         if (progress && progress[`day${i}Completed`]) completedDays.push(i);
      }
      
      const achievements = gamificationSystem.calculateAchievements({
         completedDays,
         totalMoneySaved: progress?.totalMoneySaved || 0
      });
      
      let completionMsg = `✅ **មេរៀនថ្ងៃទី ${dayNumber} ត្រូវបានផ្ញើរួចរាល់!**\n\n`;
      
      if (achievements.length > 0) {
         completionMsg += `🎖️ **ជោគជ័យរបស់អ្នក:**\n${achievements.join('\n')}\n\n`;
      }
      
      completionMsg += `💡 **បន្ទាប់:**
- អនុវត្តតាមសកម្មភាពក្នុងមេរៀន
- ចុច /day${dayNumber} ដើម្បីត្រលប់ទៅមេនុ
- ឬចុច ⭐ ដើម្បីបញ្ចប់ថ្ងៃនេះ`;
      
      await bot.sendMessage(chatId, completionMsg, { parse_mode: 'Markdown' });
      
   } catch (error) {
      console.error("Error in enhanced startLesson:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'startLesson');
   }
}

/**
 * Enhanced simplified lesson fallback
 */
function getSimplifiedLesson(dayNumber) {
   const simplified = {
      1: `🔱 **ថ្ងៃទី ១៖ រកប្រាក់ភ្លាមៗ $50-150** 🔱

🚨 **ការធានាថ្ងៃនេះ:** អ្នកនឹងរកប្រាក់បាន $50-150 ក្នុងរយៈពេល ៣០ នាទី!

💎 **បេសកកម្មរកប្រាក់ភ្លាមៗ:**

⚡ **បេសកកម្មទី១:** ស្វែងរកការជាវលាក់កំបាំង (៨ នាទី = $15-85)
🎯 **ការធានា:** រកបាន $15+ ភ្លាមៗ!

**ជំហានស្វែងរក:**
📱 បើកការកំណត់ទូរស័ព្ទ → Subscriptions
🔍 រកមើលកម្មវិធីដែលអ្នកភ្លេចថាកំពុងបង់ប្រាក់
💸 គណនាចំនួនប្រាក់ដែលកំពុងខាតបង់

🇰🇭 **ចំណុចលេចធ្លាយប្រាក់ឌីជីថលទូទៅនៅកម្ពុជា:**

📺 Netflix/YouTube Premium ដែលលែងមើល៖ $12-15/ខែ = $144-180/ឆ្នាំ
🎵 Spotify Premium ដែលលែងស្ដាប់៖ $10/ខែ = $120/ឆ្នាំ
🎮 កម្មវិធីហ្គេម (PUBG UC, Free Fire)៖ $8-25/ខែ = $96-300/ឆ្នាំ
🔒 VPN ពីមុន ដែលភ្លេចបិទ៖ $5-12/ខែ = $60-144/ឆ្នាំ

⚡ **បេសកកម្មទី២:** វិភាគទម្លាប់ចំណាយកម្ពុជា (១២ នាទី = $25-50)

🚗 **ការធ្វើដំណើរ (ចំណុចសន្សំធំបំផុត):**
- Grab ចម្ងាយខ្លី ក្រោម ២ គីឡូម៉ែត្រ៖ $3-5/ដង × 12ដង/ខែ = $36-60/ខែ
- ឆ្លាតវៃ៖ ជិះម៉ូតូដូប/កង់ ចម្ងាយ < 1km = សន្សំ $30/ខែ + ហាត់ប្រាណ

☕ **កាហ្វេ និង ភេសជ្ជៈ (កន្លែងសន្សំងាយបំផុត):**
- កាហ្វេហាង (Brown/Amazon/Starbucks)៖ $2.5/ថ្ងៃ × 20ថ្ងៃ = $50/ខែ
- ឆ្លាតវៃ៖ កាហ្វេនៅផ្ទះ $0.5/ថ្ងៃ = សន្សំ $40/ខែ = $480/ឆ្នាំ

🍔 **ថ្លៃដឹកជញ្ជូនអាហារ (ចំណុចលាក់សំខាន់):**
- FoodPanda/Grab Food delivery fee + tips៖ $1-2 × 15ដង = $15-30/ខែ
- ឆ្លាតវៃ៖ meal prep ថ្ងៃអាទិត្យ + ទុកទូកត្រជាក់ = សន្សំ $40-80/ខែ

🏆 **សរុបប្រាក់ដែលទើបរកបាន:**
ខែនេះ៖ $____ | ឆ្នាំនេះ៖ $____

✅ **ការបញ្ចប់បេសកកម្មថ្ងៃទី១:**
📢 សូមសរសេរសារបញ្ចាក់៖ "DAY 1 COMPLETE - រកបាន $____/ខែ"

📞 **ជំនួយ:** @Chendasum`,

      2: `🔱 **ថ្ងៃទី ២៖ ស្វែងរកចំណុចលេចលុយកម្រិតខ្ពស់** 🔱

🎯 **គោលដៅ:** រកចំណុចលេចលុយ $100+ ក្នុង ៤៥ នាទី

⚡ **បេសកកម្មទី១:** អន្ទាក់បណ្តាញសង្គម (១៥ នាទី)
📱 ពិនិត្យ Facebook/Instagram/TikTok payment history
🔍 រកការចំណាយដោយមិនចាំបាច់

⚡ **បេសកកម្មទី២:** ការជាវលាក់កំបាំង (១៥ នាទី)
📧 ស្វែងរក email "subscription", "renewal"
🏦 ពិនិត្យ bank statement រកការកាត់ស្វ័យប្រវត្តិ

⚡ **បេសកកម្មទី៣:** ទម្លាប់តូចៗប្រចាំថ្ងៃ (១៥ នាទី)
☕ កាហ្វេ, ភេសជ្ជៈ, បារី
🚗 ការធ្វើដំណើរមិនចាំបាច់

📞 **ជំនួយ:** @Chendasum`,

      3: `🔱 **ថ្ងៃទី ៣៖ ពិនិត្យសុខភាពហិរញ្ញវត្ថុ** 🔱

📊 **គោលដៅ:** ទទួលពិន្ទុសុខភាពហិរញ្ញវត្ថុក្នុង ១៥ នាទី

⚡ **ការវាយតម្លៃ ៣ ផ្នែក:**
1. ការតាមដាន (Tracking): A-F
2. ការរៀបចំផែនការ (Planning): A-F  
3. មូលនិធិបន្ទាន់ (Emergency Fund): A-F

🏆 **ពិន្ទុសរុប:**
- 90-100%: A+ ពិសេស
- 80-89%: A ល្អណាស់
- 70-79%: B ល្អ
- 60-69%: C មធ្យម
- 50-59%: D ត្រូវកែលម្អ
- < 50%: F ត្រូវការជំនួយ

📞 **ជំនួយ:** @Chendasum`,

      4: `🔱 **ថ្ងៃទី ៤៖ គណនាលំហូរប្រាក់ពិត** 🔱

📈 **គោលដៅ:** យល់ពីលំហូរប្រាក់ពិតក្នុង ១០ នាទី

⚡ **ជំហានគណនា:**
1. ចំណូលសរុប: $____
2. ចំណាយសរុប: $____
3. លំហូរប្រាក់ = ចំណូល - ចំណាយ: $____

🎯 **លទ្ធផល:**
- វិជ្ជមាន (+): ល្អ!
- សូន្យ (0): គ្រោះថ្នាក់
- អវិជ្ជមាន (-): បន្ទាន់!

📞 **ជំនួយ:** @Chendasum`,

      5: `🔱 **ថ្ងៃទី ៥៖ វិភាគតុល្យភាពចំណាយ** 🔱

⚖️ **គោលដៅ:** យល់ពីតុល្យភាពចំណាយក្នុង ១៥ នាទី

⚡ **ចំណាយ ៣ ប្រភេទ:**
1. ការរស់រាន (Survival): 50-65%
2. ការលូតលាស់ (Growth): 20-30%
3. របៀបរស់នៅ (Lifestyle): 10-25%

🎯 **តុល្យភាពដ៏ល្អ:** 60/25/15

📞 **ជំនួយ:** @Chendasum`,

      6: `🔱 **ថ្ងៃទី ៦៖ ម៉ាទ្រីសអាទិភាព** 🔱

🎬 **គោលដៅ:** កំណត់សកម្មភាព ៣ យ៉ាងក្នុង ១០ នាទី

⚡ **ម៉ាទ្រីស Stop/Start/Continue:**
🛑 STOP: បញ្ឈប់អ្វី? (ចំណាយមិនល្អ)
▶️ START: ចាប់ផ្តើមអ្វី? (ទម្លាប់ល្អ)
🔄 CONTINUE: បន្តអ្វី? (អ្វីដែលធ្វើបានល្អ)

🗓️ **ផែនការ ៣០ ថ្ងៃ:** ការអនុវត្តច្បាស់លាស់

📞 **ជំនួយ:** @Chendasum`,

      7: `🔱 **ថ្ងៃទី ៧៖ បញ្ចប់ការសិក្សា** 🔱

🎓 **គោលដៅ:** វាស់ជោគជ័យ និងជំហានបន្ទាប់

⚡ **សមិទ្ធផលរបស់អ្នក:**
💰 ប្រាក់សន្សំបាន: $____/ខែ
📈 កម្រិតបញ្ចប់: Bronze/Silver/Gold/Platinum

🏆 **ក្រាដបញ្ចប់ការសិក្សា:**
- $50+: Bronze Graduate 🥉
- $100+: Silver Graduate 🥈  
- $200+: Gold Graduate 🥇
- $300+: Platinum Graduate 💎

🚀 **ជំហានបន្ទាប់:** ការបន្តទម្លាប់ល្អ

📞 **ជំនួយ:** @Chendasum`
   };
   
   return simplified[dayNumber] || `📚 មេរៀនថ្ងៃទី ${dayNumber} កំពុងត្រូវបានត្រៀម...\n\n📞 ទាក់ទង @Chendasum`;
}

/**
 * Enhanced program overview with achievements
 */
async function showProgramOverview(bot, chatId, messageId, userId) {
   try {
      const progress = await Progress.findOne({ user_id: userId });
      if (!progress) return;
      
      const completedDays = [];
      for (let i = 1; i <= 7; i++) {
         if (progress[`day${i}Completed`]) {
            completedDays.push(i);
         }
      }
      
      const overviewMessage = generateProgramOverview({ 
         completedDays, 
         currentDay: progress.currentDay || 1,
         totalMoneySaved: progress.totalMoneySaved || 0
      });
      
      const backKeyboard = {
         inline_keyboard: [[
            { text: "🔙 ត្រលប់ក្រោយ", callback_data: `day_${progress.currentDay || 1}` },
            { text: "🏅 ជោគជ័យ", callback_data: "achievements" }
         ]]
      };
      
      await bot.editMessageText(overviewMessage, {
         chat_id: chatId,
         message_id: messageId,
         parse_mode: 'Markdown',
         reply_markup: backKeyboard
      });
   } catch (error) {
      console.error("Error in showProgramOverview:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'showProgramOverview');
   }
}

/**
 * Enhanced day completion with achievement tracking
 */
async function markDayComplete(userId, dayNumber) {
   try {
      const progress = await Progress.findOne({ user_id: userId });
      
      // Calculate estimated money saved based on day
      const moneySavedEstimates = {
         1: 75,   // Day 1: Quick wins
         2: 100,  // Day 2: Advanced leak detection
         3: 50,   // Day 3: Health check improvements
         4: 80,   // Day 4: Cash flow optimization
         5: 120,  // Day 5: Balance improvements
         6: 60,   // Day 6: Action prioritization
         7: 90    // Day 7: Final optimizations
      };
      
      let totalMoneySaved = progress?.totalMoneySaved || 0;
      if (!progress?.[`day${dayNumber}Completed`]) {
         totalMoneySaved += moneySavedEstimates[dayNumber] || 0;
      }
      
      const completionData = {
         [`day${dayNumber}Completed`]: true,
         [`day${dayNumber}CompletedAt`]: new Date(),
         totalMoneySaved: totalMoneySaved,
         completionPercentage: Math.floor((dayNumber / CONFIG.TOTAL_DAYS) * 100),
         lastActive: new Date()
      };

      // Unlock next day
      if (dayNumber < CONFIG.TOTAL_DAYS) {
         completionData.currentDay = dayNumber + 1;
      }

      // Enhanced program completion with graduation levels
      if (dayNumber === CONFIG.TOTAL_DAYS) {
         completionData.programCompleted = true;
         completionData.completionDate = new Date();
         
         // Determine graduation level
         if (totalMoneySaved >= 300) completionData.graduationLevel = 'Platinum';
         else if (totalMoneySaved >= 200) completionData.graduationLevel = 'Gold';
         else if (totalMoneySaved >= 100) completionData.graduationLevel = 'Silver';
         else completionData.graduationLevel = 'Bronze';
      }

      await Progress.findOneAndUpdate(
         { user_id: userId }, 
         completionData, 
         { new: true, upsert: true }
      );

      return true;
   } catch (error) {
      console.error("Error marking day complete:", error);
      return false;
   }
}

/**
 * Show user achievements
 */
async function showUserAchievements(bot, chatId, userId) {
   try {
      const progress = await Progress.findOne({ user_id: userId });
      const completedDays = [];
      for (let i = 1; i <= 7; i++) {
         if (progress && progress[`day${i}Completed`]) completedDays.push(i);
      }
      
      const achievements = gamificationSystem.calculateAchievements({
         completedDays,
         totalMoneySaved: progress?.totalMoneySaved || 0
      });
      
      let message = `🏆 **ជោគជ័យរបស់អ្នក**\n\n`;
      
      if (achievements.length > 0) {
         message += achievements.join('\n') + '\n\n';
         message += `💰 **សរុបប្រាក់សន្សំបាន:** ${progress?.totalMoneySaved || 0}/ខែ\n`;
         message += `📊 **វឌ្ឍនភាព:** ${completedDays.length}/7 ថ្ងៃ (${Math.round(completedDays.length/7*100)}%)\n\n`;
      } else {
         message += `🎯 **ចាប់ផ្តើមជោគជ័យដំបូង!**\nបញ្ចប់ថ្ងៃទី 1 ដើម្បីទទួលសញ្ញាបត្រដំបូង\n\n`;
      }
      
      // Show next milestone
      const nextMilestone = getNextMilestone(progress?.totalMoneySaved || 0, completedDays.length);
      if (nextMilestone) {
         message += `🎯 **គោលដៅបន្ទាប់:** ${nextMilestone}`;
      }
      
      await bot.sendMessage(chatId, message, { parse_mode: 'Markdown' });
   } catch (error) {
      console.error("Error showing achievements:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'showUserAchievements');
   }
}

/**
 * Send personalized tip
 */
async function sendPersonalizedTip(bot, chatId, userId, dayNumber) {
   try {
      const progress = await Progress.findOne({ user_id: userId });
      const tips = {
         1: `💡 **គន្លឹះថ្ងៃទី 1:** 
ស្វែងរក "micro-subscriptions" - ការជាវតូចៗដែលគេតែងភ្លេច!
• Apple iCloud storage $0.99/ខែ
• Google Photos storage $1.99/ខែ  
• កម្មវិធីកែរូប $4.99/ខែ
នេះអាចជាប្រាក់ $100+ ក្នុងមួយឆ្នាំ!`,

         2: `💡 **គន្លឹះថ្ងៃទី 2:**
ពិនិត្យ "social spending triggers" - ពេលណាអ្នកចំណាយច្រើន?
• នៅពេលស្ត្រេស? 
• ជាមួយមិត្តភក្តិ?
• នៅពេលយប់?
ការយល់ដឹងពីនេះជួយបញ្ឈប់ការចំណាយដោយអារម្មណ៍!`,

         3: `💡 **គន្លឹះថ្ងៃទី 3:**
ប្រើ "តេស្ត 72 ម៉ោង" សម្រាប់ការទិញធំៗ:
ថ្ងៃទី 1: ចង់ទិញ
ថ្ងៃទី 2: នៅតែចង់ទិញ?
ថ្ងៃទី 3: នៅតែត្រូវការពិតៗ?
80% នៃការចង់ទិញនឹងបាត់ទៅ!`,

         4: `💡 **គន្លឹះថ្ងៃទី 4:**
បង្កើត "Visual Cash Flow" ដោយប្រើកែវ 2 ใบ:
កែវ 1: លុយចូល (ដាក់ថ្ម)
កែវ 2: លុយចេញ (ដកថ្ម)
មើលឃើញភ្លាមៗថាតើអ្នកកំពុងរីកចម្រើន ឬ ក្រីក្រ!`,

         5: `💡 **គន្លឹះថ្ងៃទី 5:**
ប្រើគោលការណ៍ "50-30-20 Cambodia Style":
• 50% ចំណាយចាំបាច់ (ផ្ទះ, អាហារ)
• 30% ការលូតលាស់ (ការសិក្សា, ការវិនិយោគ)  
• 20% ការកម្សាន្ត
ផ្លាស់ប្តូរពី "បច្ចិម" 50-20-30!`,

         6: `💡 **គន្លឹះថ្ងៃទី 6:**
បង្កើត "មន្ត្រថ្ងៃនេះ":
"តើវានឹងជួយខ្ញុំឱ្យកាន់តែរីកចម្រើនដែរឬទេ?"
សួរមុនពេលសម្រេចចិត្តរាល់ការចំណាយ!`,

         7: `💡 **គន្លឹះបញ្ចប់:**
បង្កើត "Money Flow Ritual" ប្រចាំសប្តាហ៍:
ថ្ងៃអាទិត្យ ល្ងាច = 15 នាទីពិនិត្យលុយ
• មើលអ្វីដែលបានចំណាយ
• គ្រោងសម្រាប់សប្តាហ៍បន្ទាប់
• អបអរជោគជ័យតូចៗ
ទម្លាប់នេះនឹងផ្លាស់ប្តូរជីវិតអ្នក!`
      };
      
      const tip = tips[dayNumber] || `💡 **គន្លឹះទូទៅ:** ចងចាំថាការផ្លាស់ប្តូរតូចៗអាចបង្កើតលទ្ធផលធំ!`;
      
      await bot.sendMessage(chatId, tip, { parse_mode: 'Markdown' });
   } catch (error) {
      console.error("Error sending personalized tip:", error);
      await errorHandling.gracefulFallback(bot, chatId, error, 'sendPersonalizedTip');
   }
}

/**
 * Get next milestone for user motivation
 */
function getNextMilestone(totalSaved, completedDays) {
   if (completedDays < 3) return "បញ្ចប់ថ្ងៃទី 3 ដើម្បីទទួល '🔥 ការប្តេជ្ញាចិត្ត 3 ថ្ងៃ'";
   if (totalSaved < 100) return "សន្សំ $100 ដើម្បីទទួល '💎 អ្នករកប្រាក់ Silver'";
   if (completedDays < 7) return "បញ្ចប់កម្មវិធីដើម្បីទទួល '⭐ អ្នកចាំថ្ងៃ 7 ថ្ងៃ'";
   if (totalSaved < 200) return "សន្សំ $200 ដើម្បីទទួល '🏆 អ្នករកប្រាក់ Gold'";
   return "អ្នកបានសម្រេចគោលដៅទាំងអស់! 🎉";
}

// Export enhanced functions
module.exports = { 
   handle, 
   handleCallback,
   handleDayNavigation,
   startLesson,
   getSimplifiedLesson,
   showProgramOverview,
   showUserAchievements,
   sendPersonalizedTip,
   markDayComplete,
   createDayOverview,
   createNavigationKeyboard,
   generateProgramOverview,
   generateProgressBar,
   contentOptimization,
   gamificationSystem,
   errorHandling
};

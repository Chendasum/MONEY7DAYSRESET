const User = require("../models/User");
const Progress = require("../models/Progress");
const celebrations = require("../services/celebrations");
const emojiReactions = require("../services/emoji-reactions");
const quotesCommands = require("./quotes");

const dailyMessages = {
   1: `ថ្ងៃទី ១: ចាប់ផ្តើមស្គាល់ Money Flow របស់អ្នក!

👋 ជំរាបសួរ! ថ្ងៃនេះយើងនឹងមកយល់ដឹងអំពីលុយរបស់អ្នកឱ្យបានច្បាស់លាស់!

🎯 តើហេតុអ្វីបានជាលំហូរលុយ (Money Flow) សំខាន់?

💡 លំហូរលុយ = លុយចូល - លុយចេញ = សេសសល់

ជីវិតរបស់យើងដូចជាបង្អួច... លុយចូលពីមួយទ្វារ ហើយចេញពីទ្វារមួយទៀត។ បញ្ហាគឺ យើងភាគច្រើនមិនដឹងថាវាចេញតាមផ្លូវណាខ្លះ!

ការគ្រប់គ្រងលំហូរលុយមិនមែនគ្រាន់តែរាប់លុយឡើយ... វាដូចជាការធ្វើកំណត់ហេតុសុខភាពហិរញ្ញវត្ថុរបស់អ្នក!

💰 លុយចូលមកពីណាខ្លះ? (៤ ប្រភេទសំខាន់)

🟢 ចំណូលទៀងទាត់:
   • ប្រាក់ខែ ឬ ប្រាក់ថ្ងៃពីការងារ
   • កុំម៉ីសស៊ិនពីការលក់
   • ប្រាក់ពីកិច្ចសន្យាការងារ

🔵 ចំណូលបន្ថែម:
   • ធុរកិច្ចតូចៗដែលធ្វើនៅពេលទំនេរ
   • ការបង្រៀនបន្ថែម
   • ការលក់ទំនិញតាមអនឡាញ

🟡 ចំណូលដោយស្វ័យប្រវត្តិ:
   • ការប្រាក់ពីធនាគារ
   • ការវិនិយោគ (បើមាន)
   • ផ្ទះជួល ឬ បន្ទប់

🟠 ចំណូលម្តងម្កាល:
   • ប្រាក់រង្វាន់
   • ប្រាក់អំណោយពីកាដូរ/Gifts
   • ការលក់របស់របរចាស់ៗ

💸 លុយចេញទៅណាខ្លះ? (៤ ក្រុមសំខាន់)

🔴 ចំណាយចាំបាច់ (៤០-៥០%):
   • ជួលផ្ទះ, ទឹក ភ្លើង អនឡាញ
   • ថ្លៃសាលារៀនកូនៗ
   • ប្រាក់កម្ចីធនាគារ/ប្រាក់បង់រំលោះ
   • ធានារ៉ាប់រង, ទូរស័ព្ទ

🟡 ចំណាយអាហារ និងសំលៀកបំពាក់ (២៥-៣៥%):
   • ម្ហូបអាហារ
   • សំលៀកបំពាក់
   • ថ្នាំពេទ្យ ឬ ថ្លៃព្យាបាល
   • ការធ្វើដំណើរ

🟢 ចំណាយកម្សាន្ត (១៥-២៥%):
   • ទៅកម្សាន្តកន្លែងនានា
   • ញ៉ាំកាហ្វេ នៅហាង
   • ទិញអ្វីដែលចង់បាន
   • កីឡា និង Hobby

🔵 ចំណាយពិសេស:
   • ពិធីបុណ្យផ្សេងៗ
   • ជួយសមាជិកគ្រួសារ
   • ជួសជុលផ្ទះ ឬ ម៉ូតូ

🎯 ការគណនាឆ្លាតវៃ:
ចំណូលសរុប - ចំណាយសរុប = សេសសល់

ឧទាហរណ៍: ចំណូល $800 - ចំណាយ $750 = សល់ $50

បើលុយសល់ = ល្អ 👍
បើលុយអស់ = ត្រូវកែឡើងវិញ

📊 ក្បួន ៥០/៣០/២០ (The Golden Rule):
ជាឧទាហរណ៍ ចំណូលប្រចាំខែ $1000:
🔴 ៥០% = $500 ចាំបាច់ (ផ្ទះ, អាហារ, ការធ្វើដំណើរ)
🟡 ៣០% = $300 ចង់បាន (កម្សាន្ត, ទិញអ្វីល្អៗ)
🟢 ២០% = $200 សន្សំ (អនាគត, បន្ទាន់)

ក្បួន The Golden Rule នេះជួយ:
✅ មិនចំណាយលើស
✅ មានលុយសន្សំ
✅ រស់នៅមានតុល្យភាព

🎯 អ្វីដែលត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ចាប់ផ្តើមពិនិត្យចំណូលរបស់អ្នក
→ គិតមើលថាអ្នកមានចំណូលពីប៉ុន្មានប្រភព?
→ មួយណាទៀងទាត់ មួយណាមិនស្ថេរ?

✅ ជំហានទី២ - ពិនិត្យចំណាយរបស់អ្នក
→ ថ្ងៃណាខ្លះដែលចំណាយច្រើនបំផុត?
→ ចំណាយមួយណាដែលអ្នកអាចកាត់បន្ថយបាន?

💭 សំណួរសម្រាប់ការពិចារណាដោយខ្លួនឯង:
១. "តើចំណូលរបស់ខ្ញុំមកពីប៉ុន្មានប្រភព? មានតែមួយប៉ុណ្ណោះ ឬ មានច្រើន?"
២. "ចំណាយមួយណាខ្លះដែលខ្ញុំអាចកាត់បន្ថយបាន?"
៣. "ខ្ញុំចំណាយច្រើនលើអ្វីដែលចាំបាច់ ឬ លើអ្វីដែលចង់បាន?"
៤. "បើសិនជាមានបញ្ហាបន្ទាន់ ខ្ញុំមានលុយទុកដែរឬទេ?"

🎉 គន្លឹះជោគជ័យ:
- ត្រូវតែស្មោះត្រង់ - កុំលាក់បាំងតួរលេខ!
- មើលរយៈពេលវែង - ពិនិត្យចាំ ៣-៦ ខែ
- ផ្តោតលើទម្លាប់ចំណាយ មិនមែនតែចំនួនលុយច្រើនតិច
- រកមូលហេតុ កុំត្រឹមតែកែលម្អលទ្ធផល

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមកត់ត្រាចំណាយជារៀងរាល់ថ្ងៃ
- ត្រូវប្រយ័ត្នចំណាយ "តូចៗ" (ពួកវាបង្កើនយ៉ាងលឿន!)

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 1 COMPLETE" ដើម្បីឆ្ពោះទៅថ្ងៃទី ២!

ស្អែកយើងនឹងធ្វើការស្វែងរក "កន្លែងលុយលេចធ្លាយ" ដើម្បីរកកន្លែងដែលលុយលេចទៅមិនដឹងខ្លួន!

🌐 More resources: 7daymoneyflow.com

បញ្ចប់? ចុច /day2`,

   2: `ថ្ងៃទី ២: ស្វែងរកកន្លែងលុយលេច - កន្លែងដែលថង់លុយតែងតែលេចធ្លាយ!

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃម្សិលមិញអ្នកបានស្គាល់លំហូរលុយរបស់ខ្លួនហើយ។ ថ្ងៃនេះយើងនឹងធ្វើជា "អ្នកស្វែងរក" ដើម្បីរកកន្លែងដែលលុយលេចធ្លាយដោយមិនដឹងខ្លួន!

🚨 តើកន្លែងលុយលេចជាអ្វី?

កន្លែងលុយលេច គឺដូចជាបំពង់ទឹកដែលលេចតូចៗ... ពេលដំបូងមិនសូវកត់សម្គាល់ តែប￾ទុកចោលយូរ វានឹងធ្វើឱ្យអ្នកខាតទឹកយ៉ាងច្រើន!

💡 ឧទាហរណ៍ចំណាយប្រចាំថ្ងៃដែលគេចូលចិត្ត:
- កាហ្វេ $2 × ៣០ថ្ងៃ = $60/ខែ = $720/ឆ្នាំ!
- Grab $5 × ១៥ដង = $75/ខែ
- Subscription មិនប្រើ = $20/ខែ

សរុប: ខាតដោយមិនដឹងខ្លួន $155/ខែ = $1,860/ឆ្នាំ!

🔍 កន្លែងដែលលុយលេចធ្លាយទាំង ៥ ប្រភេទចម្បងក្នុងកម្ពុជា:

1️⃣ DIGITAL LEAKS (ការជាវអនឡាញ)
• Netflix, Spotify ពី $5-15/ខែ
• Games (PUBG UC, Free Fire) ពី $10-30/ខែ
• Apps premium ដែលមិនប្រើ ពី $3-10/ខែ
• ប្រើ 4G លើសកញ្ចប់ ពី $5-20/ខែ

2️⃣ CONVENIENCE LEAKS (ចំណាយពេលងាយស្រួល)
• Food Delivery fees ពី $20-40/ខែ
• Grab ចម្ងាយខ្លី ពី $50/ខែ
• តាក់ស៊ីដោយមិនចាំបាច់ ពី $30+/ខែ

3️⃣ IMPULSE LEAKS (ចំណាយភ្លាមៗ)
• ឃើញ sale ទិញភ្លាម
• ទិញ promotion "ថោក" តែមិនត្រូវការ
• Shopping ពេលមានអារម្មណ៍មិនល្អ
• ទិញតាម Facebook ads សរុប $30-80/ខែ

4️⃣ SOCIAL LEAKS (ចំណាយសង្គម)
• KTV, Bar, Club ពី $20-50/ដង
• ទិញស្រាបៀរលើសកំណត់ ពី $10-30/ខែ
• ចំណាយលើសក្នុងក្រុមមិត្តភក្ដិ ពី $40-100/ខែ

5️⃣ MICRO LEAKS (ចំណាយតូចៗ)
• កាហ្វេហាង ពី $40/ខែ
• ទិញអាហារសម្រន់ផ្សេងៗ ពី $30/ខែ
• ភេសជ្ជៈ(Ice/drinks) ពី $15/ខែ
• ជួយគេញឹកញាប់ ពី $20-60/ខែ

🎯 អ្វីដែលត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ពិនិត្យចំណាយរយៈពេល ៣០ ថ្ងៃចុងក្រោយ
→ មើលថាអ្នកតែងតែចំណាយលើប្រភេទអ្វីខ្លះ?
→ មួយណាដែលចំណាយច្រើនជាងគេបំផុត?

✅ ជំហានទី២ - កំណត់អាទិភាពការកាត់បន្ថយ
→ មួយណាត្រូវកាត់ភ្លាមៗ (ចំណាយច្រើន + មិនចាំបាច់)
→ មួយណាត្រូវកាត់បន្ថយបន្តិច (ចំណាយមធ្យម + អាចកាត់បាន)

🎯 យុទ្ធសាស្ត្រ ៤ យ៉ាងដើម្បីបិទកន្លែងលុយលេច:

1️⃣ ច្បាប់ ២៤ម៉ោង (The 24-Hour Rule)
មុនពេលសម្រេចចិត្តទិញលើស $20 → ត្រូវរង់ចាំ ២៤ម៉ោង

2️⃣ ពិនិត្យការជាវ (Subscription Review)
រាល់ខែត្រូវឧស្សាហ៍ពិនិត្យការជាវទាំងអស់ម្តងទៀត

3️⃣ ការកំណត់ប្រាក់កម្សាន្ត (Cash Allowance)
ដកសាច់ប្រាក់ចំនួនកំណត់ សម្រាប់តែការកម្សាន្តប៉ុណ្ណោះ

4️⃣ យុទ្ធសាស្ត្ររកជំនួស (Substitute Strategy)
រកជម្រើសដែលមានតម្លៃធូរជាង:
• ធ្វើកាហ្វេនៅផ្ទះ > ទិញកាហ្វេហាង
• ធ្វើម្ហូបនៅផ្ទះ > បញ្ជាម្ហូបមកផ្ទះ
• ម៉ូតូ/ឡានផ្ទាល់ខ្លួន > Taxi Grab

---

💭 សំណួរសម្រាប់ការពិចារណា:

១. "កន្លែងលុយលេចណាខ្លះដែលធ្វើឱ្យខ្ញុំភ្ញាក់ផ្អើលបំផុត?"
២. "ចំណាយណាដែលកើតឡើងដោយសារអារម្មណ៍ (ស្ត្រេស, ធុញ, ក្រៀមក្រំ)?"
៣. "បើសិនជាខ្ញុំអាចសន្សំបាន $50/ខែ ឬលើសពីនេះ នឹងយកទៅប្រើប្រាស់ធ្វើអ្វី?"

---

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីចំនុចតូចបំផុត - កាត់កន្លែងលុយលេចតែ ២-៣ យ៉ាងមុនសិន
• រកជម្រើសជំនួស - កុំបញ្ឈប់ទាំងស្រុង រកជម្រើសថោកជាង
• តាមដានលទ្ធផលទទួលបាន - កត់ត្រាប្រាក់សន្សំបានរាល់សប្តាហ៍
• ផ្តល់រង្វាន់ដល់ខ្លួនឯង - ប្រើ ២០% នៃប្រាក់សន្សំទិញអ្វីដែលពិតជាចង់បាន

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមអនុវត្តយុទ្ធសាស្ត្រទាំង ៤ នេះ
- កត់ត្រាចំណាយជារៀងរាល់ថ្ងៃ
- ត្រូវសង្កេតមើលអារម្មណ៍របស់អ្នកនៅពេលចង់ចំណាយ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

---

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 2 COMPLETE" + ចែករំលែកការសន្សំបានប៉ុន្មាន!

ស្អែកយើងនឹងវាយតម្លៃ "ប្រព័ន្ធគ្រប់គ្រងលុយបច្ចុប្បន្ន" របស់អ្នក!

---

បញ្ចប់? ចុច /day3`,

   3: `ថ្ងៃទី ៣: ពិនិត្យប្រព័ន្ធគ្រប់គ្រងលុយបច្ចុប្បន្ន

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃនេះយើងនឹងមកពិនិត្យមើលថា "តើអ្នកគ្រប់គ្រងលុយយ៉ាងណាក្នុងពេលបច្ចុប្បន្ន?"

ពីម្សិលមិញ អ្នកបានស្គាល់លំហូរលុយ និងកន្លែងលុយលេចហើយ។ ថ្ងៃនេះ មកមើលថាតើអ្នកមានប្រព័ន្ធអ្វីខ្លះដើម្បីគ្រប់គ្រងលុយ។

📊 ពិនិត្យ ៣ ផ្នែកសំខាន់ៗ:

1️⃣ TRACKING (ការតាមដាន)
🔍 តើអ្នកបានតាមដានលុយចូល-ចេញដោយរបៀបណា?

📱 ជម្រើសទូទៅដែលអ្នកអាចតាមដានបាន:
• App (Khmer Money Manager, Spendee)
• Excel/Google Sheet
• សៀវភៅសរសេរដៃ
• គ្រាន់តែចាំក្នុងចិត្ត

2️⃣ BUDGETING (ការបែងចែកលុយ)
💰 តើអ្នកមានការបែងចែកលុយសម្រាប់ការប្រើប្រាស់ដែរឬទេ?

📊 ប្រភេទថវិកាទូទៅ:
• ក្បួន 50/30/20: ចាំបាច់ 50%, ចង់បាន 30%, សន្សំ 20%
• ក្បួន Pay Yourself First: សន្សំមុន, ចំណាយក្រោយ
• Free Spending: ចំណាយតាមចិត្ត

3️⃣ SAVING (ការសន្សំ)
💎 តើអ្នកសន្សំលុយបានល្អឬទេ?

🏦 ប្រភេទការសន្សំ:
• Emergency Fund: សន្សំសម្រាប់ពេលបន្ទាន់
• Goal-Based: សន្សំសម្រាប់គោលដៅ
• Auto-Save: ដាក់ការសន្សំដោយស្វ័យប្រវត្តិ

🎯 អ្វីដែលត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ពិនិត្យវាយតម្លៃខ្លួនឯង
→ ក្នុងចំណោម ៣ ផ្នែកខាងលើ មួយណាដែលអ្នកធ្វើបានល្អបំផុត?
→ មួយណាដែលអ្នកត្រូវការកែលម្អបន្ថែមទៀត?

✅ ជំហានទី២ - ជ្រើសរើសផ្នែកសម្រាប់ការកែលម្អ
→ ជ្រើសរើសតែ ១ ឬ ២ ផ្នែកប៉ុណ្ណោះដើម្បីចាប់ផ្តើម
→ កំណត់វិធីសាស្ត្រដែលសាមញ្ញ និងងាយស្រួលតាមដាន

💭 សំណួរសម្រាប់ការពិចារណា:

១. "ផ្នែកមួយណាដែលខ្ញុំចង់កែលម្អជាចម្បង?"
២. "តើវិធីសាស្ត្របែបណាខ្លះដែលងាយស្រួលសម្រាប់ខ្ញុំអាចតាមដាន?"
៣. "អ្វីដែលរាំងខ្ញុំគ្រប់គ្រងលុយ?"
៤. "តើខ្ញុំត្រូវការជំនួយបន្ថែមលើផ្នែកណាខ្លះ?"

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីចំនុចតូចបំផុត - កែលម្អតែ ១ ផ្នែកមុនសិន
• ប្រើប្រាស់វិធីងាយស្រួល - កុំធ្វើស្មុគស្មាញ
• ព្យាយាមអនុវត្តរយៈពេល ១ សប្តាហ៍ជាមុនសិន

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចាប់ផ្តើមកែលម្អផ្នែកដែលបានជ្រើសរើស
- ពិសោធន៍ជាមួយនឹងវិធីសាស្ត្រថ្មី
- ត្រៀមខ្លួនរៀបចំផែនទីចំណូល និងចំណាយ (Income & Cost Map)

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 3 COMPLETE" + ចែករំលែកផ្នែកដែលនឹងកែលម្អ!

ស្អែកយើងនឹងបង្កើតផែនទីចំណូលចំណាយ "Income & Cost Map" ពេញលេញ!

បញ្ចប់? ចុច /day4`,

   4: `ថ្ងៃទី ៤: ស្គាល់ចំណូលនិងចំណាយ (Income & Cost Map)

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃនេះយើងនឹងមកស្គាល់ពី "លុយចូល និងលុយចេញ" របស់អ្នក។

ពីថ្ងៃមុនៗ អ្នកបានដឹងពីលំហូរលុយ, កន្លែងលុយលេច, និងប្រព័ន្ធគ្រប់គ្រងលុយហើយ។ ថ្ងៃនេះ មកមើលថាតើលុយចេញចូលរបស់អ្នកដូចម្តេច។

💰 ផ្នែកទី១: ប្រភពចំណូល (Income Sources)

🏢 ចំណូលចម្បង:
• ប្រាក់ខែ/ប្រាក់ថ្ងៃពីការងារ
• ចំណូលពីអាជីវកម្ម
• ចំណូលពីការធ្វើការដោយខ្លួនឯង

💼 ចំណូលបន្ថែម:
• ការងារក្រៅម៉ោង Part-time
• Freelancing (ការងារឯករាជ្យ)
• ការលក់ផលិតផលបន្ថែម
• ការបង្រៀនឯកជន
• ការដឹកជញ្ជូន (Grab, PassApp)

💎 ចំណូលស្វ័យប្រវត្តិ:
• ការប្រាក់ធនាគារ
• ការវិនិយោគ
• ចំណូលពីការជួលផ្ទះ/បន្ទប់
• ចំណូលពីអាជីវកម្មស្វ័យប្រវត្តិ

💸 ផ្នែកទី២: ប្រភពចំណាយ (Expense Categories)

🏠 ចំណាយស្ថេរ (រៀងរាល់ខែ):
• ជួលផ្ទះ/បន្ទប់
• ទឹក, ភ្លើង, អ៊ីនធឺណែត
• ធានារ៉ាប់រង
• កម្ចីប្រចាំខែ

🍽️ ចំណាយអថេរ (ប្រែប្រួលតាមការប្រើប្រាស់):
• ម្ហូប (ផ្ទះ + ញ៉ាំក្រៅ)
• ការធ្វើដំណើរ (សាំង, ក្រុម)
• កម្សាន្ត
• សំលៀកបំពាក់
• ថែទាំសុខភាព

🛠️ ចំណាយម្តងម្កាល:
• ជួសជុលផ្ទះ/ម៉ូតូ/ឡាន
• ចូលរួមពិធីបុណ្យផ្សេងៗ
• ជំនួយគ្រួសារ
• ការអប់រំ

🎯 អ្វីដែលត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ស្គាល់ចំណូលរបស់អ្នក
→ ចំណូលចម្បងរបស់អ្នកមកពីប្រភពណាខ្លះ?
→ តើមានចំណូលបន្ថែមផ្សេងទៀតដែរឬទេ?

✅ ជំហានទី២ - ស្គាល់ចំណាយរបស់អ្នក
→ ចំណាយធំបំផុតរបស់អ្នកចំណាយលើអ្វីខ្លះ?
→ ចំណាយមួយណាដែលអ្នកអាចត្រួតពិនិត្យបាន?

💭 សំណួរសម្រាប់ការពិចារណា:

១. "តើចំណូលរបស់ខ្ញុំមានស្ថេរភាពដែរឬទេ?"
២. "ចំណាយធំបំផុតរបស់ខ្ញុំគឺចំណាយលើអ្វីខ្លះ?"
៣. "ចំណាយមួយណាដែលខ្ញុំអាចកាត់បន្ថយបានភ្លាមៗនេះ?"
៤. "ខ្ញុំអាចបង្កើនចំណូលបានតាមរបៀបណាខ្លះ?"

🎉 គន្លឹះជោគជ័យ:

• ត្រូវតែស្ថិតក្នុងការពិត - កុំលាក់ឬកុហកអំពីចំណាយពិតប្រាកដ
• ចាប់ផ្តើមពីវិធីសាមញ្ញ - មិនចាំបាច់ធ្វើតារាងស្មុគស្មាញ
• រៀបចំផែនការសម្រាប់អនាគត - គិតពីរបៀបបង្កើនចំណូល និងកាត់បន្ថយចំណាយ

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- អ្នកនឹងស្គាល់ថាចំណាយណាខ្លះសម្រាប់ការរស់រាន (Survival Zone)
- អ្នកនឹងស្គាល់ថាចំណាយណាខ្លះសម្រាប់ការលូតលាស់ (Growth Zone)
- ត្រៀមខ្លួនចាត់ចែងចំណាយទៅជា 3 ប្រភេទ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 4 COMPLETE" + ចែករំលែកចំណូលចម្បងនិងចំណាយធំបំផុតរបស់អ្នក!

ស្អែកយើងនឹងចាត់ចំណាយទៅ "Survival vs Growth" ដើម្បីកំណត់អាទិភាពនៅក្នុងជីវិតរបស់អ្នក!

បញ្ចប់? ចុច /day5`,

   5: `ថ្ងៃទី ៥: ការរស់រាន និងការលូតលាស់ (Survival vs Growth)

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃនេះយើងនឹងរៀនចាត់ចំណាយទៅក្នុង ៣ ក្រុមសំខាន់ៗ។

ពីថ្ងៃមុនៗ អ្នកបានដឹងពីលំហូរលុយ, កន្លែងលុយលេច, ប្រព័ន្ធគ្រប់គ្រងលុយ, និងចំណូល-ចំណាយហើយ។ ថ្ងៃនេះ មកមើលថាតើចំណាយរបស់អ្នកប្រើប្រាស់ដើម្បីធ្វើអ្វីខ្លះ។

🎯 ការយល់ដឹងសំខាន់:
ចំណាយមាន ៣ ប្រភេទ៖ ការរស់រាន, ការលូតលាស់, និងរបៀបរស់នៅ។

🏠 ក្រុមទី១: ការរស់រាន (SURVIVAL)
ចំណាយដែលចាំបាច់ដើម្បីអ្នករស់បាន

🔴 ឧទាហរណ៍ចំណាយរស់រាន:
• ម្ហូបអាហារ (ធ្វើនៅផ្ទះ, ទិញតាមផ្សារ)
• ផ្ទះសម្បែង (ជួលផ្ទះ, សងកម្ចីផ្ទះ)
• ការធ្វើដំណើរចាំបាច់ (ទៅការងារ)
• ការថែទាំសុខភាពចាំបាច់ (ថ្នាំជំងឺ)
• ប្រាក់ធានារ៉ាប់រង (ជីវិត, សុខភាព)
• ទឹក, ភ្លើង, អ៊ីនធឺណែត

🚀 ក្រុមទី២: ការលូតលាស់ (GROWTH)
ចំណាយដែលជួយអ្នកឱ្យកាន់តែលូតលាស់ និងកាន់តែប្រសើរ

🟢 ឧទាហរណ៍ចំណាយសម្រាប់ការលូតលាស់:
• ការអប់រំ និងជំនាញ (វគ្គសិក្សា, សៀវភៅ)
• ការវិនិយោគ (ហ៊ុន, ប្រាក់បញ្ញើ)
• ការថែទាំសុខភាព ឬ បង្ការ (ពិនិត្យសុខភាព, ហាត់ប្រាណ)
• ឧបករណ៍ការងារ (កុំព្យូទ័រ, ប្រដាប់ប្រដា)
• ការបង្កើនបណ្តាញទំនាក់ទំនងថ្មីៗ
• ការចាប់ផ្តើមអាជីវកម្មតូច

🎭 ក្រុមទី៣: ការកំសាន្ត (LIFESTYLE)
ចំណាយសម្រាប់ការកំសាន្ត និងការរីករាយ - មិនចាំបាច់ ប៉ុន្តែធ្វើឱ្យជីវិតរីករាយ

🟡 ឧទាហរណ៍ចំណាយកំសាន្ត:
• កម្សាន្ត (ទីកន្លែងកម្សាន្ត, ភាពយន្ត)
• ការទិញទូរស័ព្ទថ្មីៗ
• សំលៀកបំពាក់ម៉ូតថ្មីៗ
• ញ៉ាំអាហារនៅក្រៅញឹកញាប់ (ហាងថ្លៃ)
• ការធ្វើដំណើរកម្សាន្ត
• របស់របរផ្សេងៗ

🎯 អ្វីដែលត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ស្គាល់ចំណាយទាំង ៣ ប្រភេទ
→ ចំណាយរបស់អ្នកភាគច្រើនជាប្រភេទណាខ្លះ?
→ ចំណាយមួយណាដែលនឹងជួយអ្នកឱ្យលូតលាស់ និងរីកចម្រើន?

✅ ជំហានទី២ - ពិចារណាអំពីតុល្យភាពនៃការចំណាយ
→ តើអ្នកកំពុងចំណាយលើការរស់រានច្រើនពេកដែរឬទេ?
→ តើអ្នកបានបែងចែកការចំណាយសម្រាប់ការលូតលាស់ដើម្បីអ្វីដែរ?

💭 សំណួរសម្រាប់ការពិចារណា:

១. "ចំណាយធំបំផុតរបស់ខ្ញុំស្ថិតក្នុងប្រភេទណាមួយ?"
២. "ខ្ញុំចំណាយលើការលូតលាស់ប៉ុន្មានភាគរយ?"
៣. "ចំណាយមួយណាដែលគ្រាន់តែធ្វើឱ្យជីវិតស្រួលជាង?"
៤. "ខ្ញុំអាចកែលម្អតុល្យភាពនេះដោយរបៀបណា?"

🎯 គោលដៅចំណាយដែលល្អ:
• ការរស់រាន (ចាំបាច់): ៥០-៦០%
• ការលូតលាស់ (វិនិយោគ): ២០-៣០%
• ការកំសាន្ត (រីករាយ): ១០-២០%

🎉 គន្លឹះជោគជ័យ:

• ចំណាយរស់រានច្រើនពេក? → ស្វែងរកជម្រើសធូរជាង (ធ្វើម្ហូបនៅផ្ទះ, ជួលផ្ទះថោក)
• ចំណាយលូតលាស់តិច? → ចាប់ផ្តើមវិនិយោគលើខ្លួនឯង (រៀនជំនាញថ្មី, សៀវភៅ)
• ចំណាយកំសាន្តច្រើនពេក? → កាត់បន្ថយការកំសាន្តមិនចាំបាច់ (ញ៉ាំក្រៅតិច, ផ្អាកដូរសេរី ឬ ទិញទូរស័ព្ទថ្មី)

💡 ការត្រៀមសម្រាប់ថ្ងៃស្អែក:
- ប្រើការយល់ដឹងនេះបង្កើត Action Plan
- ត្រៀមកំណត់គោលដៅច្បាសលាស់
- ពិចារណាវិធីសាស្ត្រអនុវត្ត

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 5 COMPLETE" + ចែករំលែកតុល្យភាពចំណាយរបស់អ្នក!

ស្អែកយើងនឹងជ្រើសរើសចំណុចធំៗ 3 យ៉ាងដើម្បីធ្វើបន្ទាប់!

បញ្ចប់? ចុច /day6`,

   6: `ថ្ងៃទី ៦: ជំហានបន្ទាប់

👋 ជំរាបសួរម្តងទៀត! ថ្ងៃនេះយើងនឹងជ្រើសរើសចំណុចធំៗ ៣ យ៉ាងដើម្បីធ្វើបន្ទាប់។

ពីថ្ងៃមុនៗ អ្នកបានដឹងពីលំហូរលុយ, កន្លែងលុយលេច, ប្រព័ន្ធគ្រប់គ្រងលុយ, ចំណូល-ចំណាយ, និងអាទិភាពចំណាយហើយ។ ថ្ងៃនេះ មកកំណត់ថាតើត្រូវធ្វើអ្វីខ្លះ។

🎯 ការយល់ដឹងសំខាន់:
ការផ្លាស់ប្តូរមិនត្រូវការច្រើន ឬស្មុគស្មាញទេ។ គ្រាន់តែ ៣ ចំណុចធំៗប៉ុណ្ណោះ។

🚫 ចំណុចទី១: ឈប់ធ្វើ (STOP)
អ្វីដែលអ្នកគួរឈប់ធ្វើ

🔴 ឧទាហរណ៍ចំណុចឈប់ធ្វើ:
• ឈប់ចំណាយលុយដោយមិនគិត
• ឈប់ទិញអ្វីដែលមិនចាំបាច់
• ឈប់ញ៉ាំនៅក្រៅញឹកញាប់
• ឈប់ប្រើប្រាស់ subscriptions ដែលមិនប្រើ
• ឈប់ទិញនៅពេលអារម្មណ៍មិនល្អ

✅ ចំណុចទី២: ចាប់ផ្តើមធ្វើ (START)
អ្វីដែលអ្នកគួរចាប់ផ្តើមធ្វើ

🟢 ឧទាហរណ៍ចំណុចចាប់ផ្តើម:
• ចាប់ផ្តើមកត់ត្រាចំណាយ
• ចាប់ផ្តើមសន្សំបន្តិចបន្តួច
• ចាប់ផ្តើមគិតមុនពេលទិញ
• ចាប់ផ្តើមរៀនអំពីលុយ
• ចាប់ផ្តើមរៀបចំគោលដៅ

🔄 ចំណុចទី៣: បន្តធ្វើ (CONTINUE)
អ្វីដែលធ្វើល្អរួចហើយ

🟡 ឧទាហរណ៍ចំណុចបន្ត:
• បន្តចំណាយដោយស្ម័គ្រចិត្ត
• បន្តសន្សំប្រាក់ឱ្យបាន
• បន្តគិតមុនពេលទិញ
• បន្តរកមាគ៌ាបង្កើនចំណូល
• បន្តសិក្សារៀនសូត្រថ្មី

🎯 អ្វីត្រូវធ្វើថ្ងៃនេះ:

✅ ជំហានទី១ - ជ្រើសរើសចំណុចមួយដើម្បីឈប់ធ្វើ
→ តើមានអ្វីដែលកំពុងធ្វើហើយគួរតែឈប់?
→ ចាប់ផ្តើមពីចំណុចងាយបំផុត

✅ ជំហានទី២ - ជ្រើសរើសចំណុចមួយដើម្បីចាប់ផ្តើមធ្វើ
→ តើមានអ្វីដែលគួរចាប់ផ្តើមធ្វើភ្លាមៗនេះ?
→ ជ្រើសរើសចំណុចងាយស្រួលបំផុត

✅ ជំហានទី៣ - ជ្រើសរើសចំណុចមួយដើម្បីបន្តធ្វើ
→ តើមានអ្វីដែលធ្វើបានល្អហើយ?
→ បន្តធ្វើឱ្យកាន់តែប្រសើរថែមទៀត

💭 សំណួរសម្រាប់ការពិចារណា:

១. "អ្វីខ្លះដែលខ្ញុំកំពុងធ្វើ ហើយធ្វើឱ្យខ្ញុំចំណាយលុយច្រើន?"
២. "ចំណុចតូចមួយណាដែលខ្ញុំអាចចាប់ផ្តើមធ្វើបានភ្លាម?"
៣. "អ្វីដែលខ្ញុំធ្វើបានល្អហើយ ហើយគួរតែបន្តធ្វើ?"

🎉 គន្លឹះជោគជ័យ:

• ចាប់ផ្តើមពីតូចៗ - កុំធ្វើម្ដងច្រើនចំនុចពេក
• ជ្រើសរើសអ្វីងាយស្រួល - កុំធ្វើស្មុគស្មាញ
• ធ្វើការជាក់ស្តែង - មិនមែនគ្រាន់តែគិតក្នុងចិត្ត

💡 ការត្រៀមខ្លួនសម្រាប់ថ្ងៃស្អែក:
- ចងចាំចំណុចទាំង ៣ ដែលបានជ្រើសរើស
- ត្រៀមខ្លួនសម្រាប់ការបញ្ចប់កម្មវិធី
- ពិចារណាអំពីការបន្តធ្វើទៅមុខ

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

✅ កិច្ចការបានបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "DAY 6 COMPLETE" + ចែករំលែក ៣ ចំណុចរបស់អ្នក!

ថ្ងៃស្អែកកម្មវិធីនឹងបញ្ចប់! យើងនឹងរៀបចំផែនការបន្តទៅមុខ!

បញ្ចប់? ចុច /day7`,

   7: `ថ្ងៃទី ៧: ការរួមបញ្ចូលទាំងអស់រួច និងជំហានបន្ទាប់

🎉 អបអរសាទរ! អ្នកបានបញ្ចប់ 7-Day Money Flow Reset™ រួចហើយ!

ពីថ្ងៃដំបូង អ្នកបានដឹងពីលំហូរលុយ, កន្លែងលុយលេច, ប្រព័ន្ធគ្រប់គ្រងលុយ, ចំណូល-ចំណាយ, អាទិភាពចំណាយ, និងជំហានបន្ទាប់ហើយ។ ថ្ងៃនេះគឺថ្ងៃរួមបញ្ចូល និងការត្រៀមខ្លួនសម្រាប់ដំណាក់កាលបន្ទាប់!

🎯 ការយល់ដឹងសំខាន់:
អ្នកមិនមែនត្រូវធ្វើអ្វីស្មុគស្មាញ។ គឺត្រូវតែ ៣ ចំណុចធំៗ។

🎊 ចំណុចទី១: អបអរសាទរ (CELEBRATE)
ស្គាល់វឌ្ឍនភាពរបស់អ្នក

🟢 ឧទាហរណ៍ការអបអរសាទរ:
- អបអរសាទរការបញ្ចប់កម្មវិធី ៧ ថ្ងៃ
- អបអរសាទរការយល់ដឹងថ្មីៗ
- អបអរសាទរការចាប់ផ្តើមគិតពីលុយ
- អបអរសាទរការកំណត់គោលដៅ
- អបអរសាទរជំហានតូចៗដែលបានធ្វើ

🔧 ចំណុចទី២: បង្កើតទម្លាប់ (BUILD HABITS)
បង្កើតទម្លាប់ល្អ

🟡 ឧទាហរណ៍ទម្លាប់ដែលគួរបង្កើត:
- ទម្លាប់គិតមុនពេលចំណាយលុយ
- ទម្លាប់កត់ត្រាចំណាយធំៗ
- ទម្លាប់ពិនិត្យលុយខ្លួនម្តងម្កាល
- ទម្លាប់សន្សំបន្តិចបន្តួច
- ទម្លាប់រៀនពីលុយជាប្រចាំ

🌱 ចំណុចទី៣: បន្តលូតលាស់ (CONTINUE GROWING)
បន្តរៀនសូត្រថ្មីៗ

🟢 ឧទាហរណ៍ការបន្តលូតលាស់:
- បន្តរៀនពីការគ្រប់គ្រងលុយ
- បន្តស្វែងរកមាគ៌ាសន្សំ
- បន្តកែលម្អទម្លាប់ចំណាយ
- បន្តរកមាគ៌ាបង្កើនចំណូល
- បន្តចែករំលែកជាមួយអ្នកដទៃ

💭 សំណួរសម្រាប់ការពិចារណា:
១. "អ្វីដែលខ្ញុំចាប់អារម្មណ៍ច្រើនបំផុត?"
២. "ទម្លាប់មួយណាដែលខ្ញុំចង់បង្កើត?"
៣. "ខ្ញុំនឹងបន្តដំណើរនេះដោយរបៀបណា?"

🎉 គន្លឹះជោគជ័យ:
- ចាប់ផ្តើមពីតូច - កុំបង្ខំខ្លួនច្រើនពេក
- ធ្វើជាទម្លាប់ - កុំធ្វើម្តងម្កាល
- ចែករំលែកជាមួយគេ - កុំលាក់ខ្លួនតែម្នាក់ឯង

💡 ការរំលឹកចុងក្រោយ:
- កម្មវិធីបញ្ចប់ហើយ ប៉ុន្តែការរៀនមិនបញ្ចប់
- ចាប់ផ្តើមអនុវត្តតាមបន្តិចម្តងៗ
- ទាក់ទងយើងវិញប្រសិនអាចជួយអ្វីបាន

🆘 ត្រូវការជំនួយ?
- មានសំណួរអ្វី? សរសេរសារមកខ្ញុំ
- ចង់សាកសួរផ្ទាល់? ទាក់ទង @Chendasum
- ប្រើ /help ដើម្បីមើលជំនួយពេញលេញ

🎊 ការអបអរសាទរ:
អ្នកបានបញ្ចប់ 7-Day Money Flow Reset™!
ឥឡូវនេះអ្នកមានចំណេះដឹងគ្រប់គ្រាន់ដើម្បីគ្រប់គ្រងលុយបានល្អជាងមុន!

🚀 ការដំណើរទើបចាប់ផ្តើម...
អ្នកបានបញ្ចប់ថ្នាក់រៀនដំបូងតែប៉ុណ្ណោះ។

🌐 Full program details: 7daymoneyflow.com

💎 មានអ្វីមួយកាន់តែពិសេស កាន់តែស្វាហាប់ កំពុងរង់ចាំ...

🤫 អ្វីដែលអ្នកទើបរៀននេះ គ្រាន់តែជា "ការគ្រប់គ្រងលុយ" តែប៉ុណ្ណោះ។

🏛️ ចុះបើអ្នកអាចធ្វើឱ្យលុយធ្វើការឱ្យអ្នកវិញ?
🔥 តើអ្នកអាចបង្កើតប្រព័ន្ធដែលលុយចូលដោយស្វ័យប្រវត្តិ?
💰 តើអ្នកអាចចូលទៅកាន់បណ្តាញឯកជនដែលមានតែអ្នកជ្រើសរើសតិចតួចទេ?

🎯 នេះហើយជាអ្វីដែលកម្រិតបន្ទាប់អាចឱ្យអ្នក...

តែមិនមែនអ្នកគ្រប់គ្នាទេដែលអាចចូលបាន។

✅ កិច្ចការបញ្ចប់:
ធ្វើរួចហើយ? សរសេរថា "PROGRAM COMPLETE" + ចែករំលែកអារម្មណ៍របស់អ្នក!

ហើយនឹងដឹងថាអ្វីមួយពិសេសកំពុងរង់ចាំ... 🤐

🏆 អរគុណដែលបានចូលរួម! ជោគជ័យក្នុងដំណើរគ្រប់គ្រងលុយ!`,
};

async function handle(msg, match, bot) {
   const dayNumber = parseInt(match[1]);
   const userId = msg.from.id;
   const chatId = msg.chat.id;

   try {
      // Check if user exists
      const user = await User.findOne({ telegramId: userId });
      if (!user) {
         await bot.sendMessage(
            chatId,
            "សូមចុច /start ដើម្បីចាប់ផ្តើមកម្មវិធី។",
         );
         return;
      }

      // Check if user has access to this day (skip day 0)
      const progress = await Progress.findOne({ userId: userId });
      if (!progress) {
         await bot.sendMessage(
            chatId,
            "សូមចុច /start ដើម្បីចាប់ផ្តើមកម្មវិធី។",
         );
         return;
      }

      // For day 1, check if user is ready
      if (dayNumber === 1 && !progress.readyForDay1) {
         await bot.sendMessage(
            chatId,
            "សូមសរសេរ 'READY FOR DAY 1' ដើម្បីចាប់ផ្តើម",
         );
         return;
      }

      // For other days, check progression
      if (dayNumber > 1 && dayNumber > progress.currentDay) {
         await bot.sendMessage(
            chatId,
            "សូមបញ្ចប់ថ្ងៃមុនដើម្បីចាប់ផ្តើមថ្ងៃបន្ទាប់។",
         );
         return;
      }

      // Send daily message with emoji reactions
      if (dailyMessages[dayNumber]) {
         // Send lesson start emoji reaction
         const startReaction = emojiReactions.lessonStartReaction(dayNumber);
         await bot.sendMessage(chatId, startReaction);

         // Short delay before main content
         setTimeout(async () => {
            await bot.sendMessage(chatId, dailyMessages[dayNumber]);
         }, 500);

         // Add celebration animation for accessing new day
         setTimeout(async () => {
            const accessCelebration = celebrations.quickCelebration(
               `ថ្ងៃទី ${dayNumber} ចាប់ផ្តើម!`,
            );
            await bot.sendMessage(chatId, accessCelebration);
         }, 1500);

         // Send daily wisdom quote after 3 seconds
         setTimeout(async () => {
            await quotesCommands.sendDayQuote(bot, chatId, dayNumber);
         }, 3000);

         // Update completion tracking after 1 second
         setTimeout(async () => {
            // Update completion tracking
            await Progress.findOneAndUpdate(
               { userId: userId },
               {
                  [`day${dayNumber}Accessed`]: true,
                  lastAccessedDay: dayNumber,
                  completionPercentage: Math.floor((dayNumber / 7) * 100),
                  lastActive: new Date(),
               },
            );
         }, 1000);

         // Send upgrade hint for Day 7 after 8 seconds
         setTimeout(async () => {
            if (dayNumber === 7) {
               const upgradeHint = `🤫 ជំហានបន្ទាប់សម្រាប់អ្នកដែលត្រៀមខ្លួនរួចរាល់...
        
👑 VIP Capital Strategy រង់ចាំអ្នកដែលបង្ហាញការប្តេជ្ញាចិត្ត

🏛️ Capital Clarity Session - ដើម្បីអ្នកដែលចង់ដឹងពីការគ្រប់គ្រងមូលធនកម្រិតខ្ពស់

ចង់ដឹងបន្ថែម? ទំនាក់ទំនង @Chendasum
🌐 More info: 7daymoneyflow.com`;

               await bot.sendMessage(chatId, upgradeHint);
            }
         }, 8000); // 8 seconds after the main content

         // Update last active
         await User.findOneAndUpdate(
            { telegramId: userId },
            { lastActive: new Date() },
         );
      } else {
         await bot.sendMessage(chatId, "រកមិនឃើញខ្លឹមសារសម្រាប់ថ្ងៃនេះ។");
      }
   } catch (error) {
      console.error("Error in daily command:", error);
      await bot.sendMessage(chatId, "សូមអភ័យទោស! មានបញ្ហាបច្ចេកទេស។");
   }
}

// Add this function after the handle function
async function markDayComplete(userId, dayNumber) {
   try {
      const updateData = {
         [`day${dayNumber}Completed`]: true,
         completionPercentage: Math.floor((dayNumber / 7) * 100),
         lastActive: new Date(),
      };

      // If completing day 7, mark program as complete
      if (dayNumber === 7) {
         updateData.programCompleted = true;
         updateData.completionDate = new Date();
      }

      await Progress.findOneAndUpdate({ userId: userId }, updateData);

      return true;
   } catch (error) {
      console.error("Error marking day complete:", error);
      return false;
   }
}

// Export the new function
module.exports = { handle, dailyMessages, markDayComplete };
